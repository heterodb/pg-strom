--#
--#       Gpu PreAggregate OverFlowed TestCases.
--#
--#   "About Calculation errors in floating-point number"
--#
--#   stddev(float4/float8) and corr(float4/float8) except 
--#   from this test case because their functions may return
--#   wrong results due to floating point error.
--# 
--#   Please refer to the following for more information.
--#   https://github.com/pg-strom/devel/wiki/Known-Issues
--#
set pg_strom.debug_force_gpupreagg to on;
set pg_strom.enable_gpusort to off;
set client_min_messages to warning;
-- smallint
select key, avg(smlint_x)::smallint            from strom_overflow_test  group by key order by key;
 key |  avg   
-----+--------
   1 |  32767
   2 |  32767
   3 |  32767
   4 |  32767
   5 |  32767
   6 |  32767
   7 |  32767
   8 |  32767
   9 |  32767
  10 |  32767
  11 | -32768
  12 | -32768
  13 | -32768
  14 | -32768
  15 | -32768
  16 | -32768
  17 | -32768
  18 | -32768
  19 | -32768
  20 | -32768
  21 |   -456
  22 |  -1106
  23 |    544
  24 |   -626
  25 |   1522
  26 |    216
  27 |   1358
  28 |    375
  29 |    411
  30 |   1208
     |       
(31 rows)

select key, count(smlint_x)::smallint          from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   945
   2 |   952
   3 |   944
   4 |   955
   5 |   949
   6 |   950
   7 |   954
   8 |   958
   9 |   940
  10 |   937
  11 |   944
  12 |   962
  13 |   946
  14 |   951
  15 |   937
  16 |   950
  17 |   950
  18 |   948
  19 |   948
  20 |   953
  21 |   956
  22 |   965
  23 |   950
  24 |   959
  25 |   954
  26 |   955
  27 |   946
  28 |   952
  29 |   955
  30 |   947
     |     0
(31 rows)

select key, max(smlint_x)::smallint            from strom_overflow_test  group by key order by key;
 key |  max   
-----+--------
   1 |  32767
   2 |  32767
   3 |  32767
   4 |  32767
   5 |  32767
   6 |  32767
   7 |  32767
   8 |  32767
   9 |  32767
  10 |  32767
  11 | -32768
  12 | -32768
  13 | -32768
  14 | -32768
  15 | -32768
  16 | -32768
  17 | -32768
  18 | -32768
  19 | -32768
  20 | -32768
  21 |  32759
  22 |  32635
  23 |  32613
  24 |  32614
  25 |  32765
  26 |  32763
  27 |  32763
  28 |  32657
  29 |  32653
  30 |  32756
     |       
(31 rows)

select key, min(smlint_x)::smallint            from strom_overflow_test  group by key order by key;
 key |  min   
-----+--------
   1 |  32767
   2 |  32767
   3 |  32767
   4 |  32767
   5 |  32767
   6 |  32767
   7 |  32767
   8 |  32767
   9 |  32767
  10 |  32767
  11 | -32768
  12 | -32768
  13 | -32768
  14 | -32768
  15 | -32768
  16 | -32768
  17 | -32768
  18 | -32768
  19 | -32768
  20 | -32768
  21 | -32735
  22 | -32759
  23 | -32731
  24 | -32729
  25 | -32736
  26 | -32632
  27 | -32701
  28 | -32747
  29 | -32722
  30 | -32759
     |       
(31 rows)

select key, sum(smlint_x)::smallint            from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, stddev(smlint_x)::smallint          from strom_overflow_test  group by key order by key;
 key | stddev 
-----+--------
   1 |      0
   2 |      0
   3 |      0
   4 |      0
   5 |      0
   6 |      0
   7 |      0
   8 |      0
   9 |      0
  10 |      0
  11 |      0
  12 |      0
  13 |      0
  14 |      0
  15 |      0
  16 |      0
  17 |      0
  18 |      0
  19 |      0
  20 |      0
  21 |  18773
  22 |  18580
  23 |  19370
  24 |  18928
  25 |  19022
  26 |  19193
  27 |  18610
  28 |  19012
  29 |  19076
  30 |  18998
     |       
(31 rows)

select key, stddev_pop(smlint_x)::smallint      from strom_overflow_test  group by key order by key;
 key | stddev_pop 
-----+------------
   1 |          0
   2 |          0
   3 |          0
   4 |          0
   5 |          0
   6 |          0
   7 |          0
   8 |          0
   9 |          0
  10 |          0
  11 |          0
  12 |          0
  13 |          0
  14 |          0
  15 |          0
  16 |          0
  17 |          0
  18 |          0
  19 |          0
  20 |          0
  21 |      18763
  22 |      18570
  23 |      19360
  24 |      18918
  25 |      19012
  26 |      19183
  27 |      18600
  28 |      19002
  29 |      19066
  30 |      18988
     |           
(31 rows)

select key, stddev_samp(smlint_x)::smallint     from strom_overflow_test  group by key order by key;
 key | stddev_samp 
-----+-------------
   1 |           0
   2 |           0
   3 |           0
   4 |           0
   5 |           0
   6 |           0
   7 |           0
   8 |           0
   9 |           0
  10 |           0
  11 |           0
  12 |           0
  13 |           0
  14 |           0
  15 |           0
  16 |           0
  17 |           0
  18 |           0
  19 |           0
  20 |           0
  21 |       18773
  22 |       18580
  23 |       19370
  24 |       18928
  25 |       19022
  26 |       19193
  27 |       18610
  28 |       19012
  29 |       19076
  30 |       18998
     |            
(31 rows)

select key, variance(smlint_x)::smallint        from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, var_pop(smlint_x)::smallint         from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, var_samp(smlint_x)::smallint        from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key,corr(smlint_x,smlint_x)::smallint  from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |     
   2 |     
   3 |     
   4 |     
   5 |     
   6 |     
   7 |     
   8 |     
   9 |     
  10 |     
  11 |     
  12 |     
  13 |     
  14 |     
  15 |     
  16 |     
  17 |     
  18 |     
  19 |     
  20 |     
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(smlint_x,smlint_x)::smallint  from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key,covar_samp(smlint_x,smlint_x)::smallint  from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
--integer
select key, avg(integer_x)::integer            from strom_overflow_test  group by key order by key;
 key |     avg     
-----+-------------
   1 |  2147483647
   2 |  2147483647
   3 |  2147483647
   4 |  2147483647
   5 |  2147483647
   6 |  2147483647
   7 |  2147483647
   8 |  2147483647
   9 |  2147483647
  10 |  2147483647
  11 | -2147483648
  12 | -2147483648
  13 | -2147483648
  14 | -2147483648
  15 | -2147483648
  16 | -2147483648
  17 | -2147483648
  18 | -2147483648
  19 | -2147483648
  20 | -2147483648
  21 |     5668695
  22 |    -8246088
  23 |  -106944425
  24 |   -44710789
  25 |    -6842367
  26 |   -24470612
  27 |   -50202566
  28 |    47273102
  29 |      367588
  30 |    -2484824
     |            
(31 rows)

select key, count(integer_x)::integer            from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   951
   2 |   957
   3 |   951
   4 |   947
   5 |   958
   6 |   948
   7 |   942
   8 |   948
   9 |   935
  10 |   939
  11 |   958
  12 |   946
  13 |   948
  14 |   959
  15 |   957
  16 |   947
  17 |   945
  18 |   954
  19 |   943
  20 |   951
  21 |   960
  22 |   948
  23 |   950
  24 |   950
  25 |   942
  26 |   959
  27 |   939
  28 |   947
  29 |   950
  30 |   959
     |     0
(31 rows)

select key, max(integer_x)::integer              from strom_overflow_test  group by key order by key;
 key |     max     
-----+-------------
   1 |  2147483647
   2 |  2147483647
   3 |  2147483647
   4 |  2147483647
   5 |  2147483647
   6 |  2147483647
   7 |  2147483647
   8 |  2147483647
   9 |  2147483647
  10 |  2147483647
  11 | -2147483648
  12 | -2147483648
  13 | -2147483648
  14 | -2147483648
  15 | -2147483648
  16 | -2147483648
  17 | -2147483648
  18 | -2147483648
  19 | -2147483648
  20 | -2147483648
  21 |  2145995259
  22 |  2135903487
  23 |  2144956465
  24 |  2146222269
  25 |  2135729653
  26 |  2147215603
  27 |  2145724325
  28 |  2146695675
  29 |  2139374637
  30 |  2142648203
     |            
(31 rows)

select key, min(integer_x)::integer              from strom_overflow_test  group by key order by key;
 key |     min     
-----+-------------
   1 |  2147483647
   2 |  2147483647
   3 |  2147483647
   4 |  2147483647
   5 |  2147483647
   6 |  2147483647
   7 |  2147483647
   8 |  2147483647
   9 |  2147483647
  10 |  2147483647
  11 | -2147483648
  12 | -2147483648
  13 | -2147483648
  14 | -2147483648
  15 | -2147483648
  16 | -2147483648
  17 | -2147483648
  18 | -2147483648
  19 | -2147483648
  20 | -2147483648
  21 | -2142927761
  22 | -2145249853
  23 | -2145732759
  24 | -2147079595
  25 | -2138022671
  26 | -2135492599
  27 | -2139814307
  28 | -2142314515
  29 | -2145742809
  30 | -2140602309
     |            
(31 rows)

select key, sum(integer_x)::integer              from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, stddev(integer_x)::integer           from strom_overflow_test  group by key order by key;
 key |   stddev   
-----+------------
   1 |          0
   2 |          0
   3 |          0
   4 |          0
   5 |          0
   6 |          0
   7 |          0
   8 |          0
   9 |          0
  10 |          0
  11 |          0
  12 |          0
  13 |          0
  14 |          0
  15 |          0
  16 |          0
  17 |          0
  18 |          0
  19 |          0
  20 |          0
  21 | 1257703825
  22 | 1249898190
  23 | 1262338596
  24 | 1236182310
  25 | 1231795299
  26 | 1221005062
  27 | 1254952332
  28 | 1237853563
  29 | 1273954581
  30 | 1245793374
     |           
(31 rows)

select key, stddev_pop(integer_x)::integer       from strom_overflow_test  group by key order by key;
 key | stddev_pop 
-----+------------
   1 |          0
   2 |          0
   3 |          0
   4 |          0
   5 |          0
   6 |          0
   7 |          0
   8 |          0
   9 |          0
  10 |          0
  11 |          0
  12 |          0
  13 |          0
  14 |          0
  15 |          0
  16 |          0
  17 |          0
  18 |          0
  19 |          0
  20 |          0
  21 | 1257048600
  22 | 1249238787
  23 | 1261674032
  24 | 1235531516
  25 | 1231141306
  26 | 1220368292
  27 | 1254283915
  28 | 1237199825
  29 | 1273283903
  30 | 1245143677
     |           
(31 rows)

select key, stddev_samp(integer_x)::integer      from strom_overflow_test  group by key order by key;
 key | stddev_samp 
-----+-------------
   1 |           0
   2 |           0
   3 |           0
   4 |           0
   5 |           0
   6 |           0
   7 |           0
   8 |           0
   9 |           0
  10 |           0
  11 |           0
  12 |           0
  13 |           0
  14 |           0
  15 |           0
  16 |           0
  17 |           0
  18 |           0
  19 |           0
  20 |           0
  21 |  1257703825
  22 |  1249898190
  23 |  1262338596
  24 |  1236182310
  25 |  1231795299
  26 |  1221005062
  27 |  1254952332
  28 |  1237853563
  29 |  1273954581
  30 |  1245793374
     |            
(31 rows)

select key, variance(integer_x)::integer         from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, var_pop(integer_x)::integer          from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, var_samp(integer_x)::integer         from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key,corr(integer_x,integer_x)::integer   from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |     
   2 |     
   3 |     
   4 |     
   5 |     
   6 |     
   7 |     
   8 |     
   9 |     
  10 |     
  11 |     
  12 |     
  13 |     
  14 |     
  15 |     
  16 |     
  17 |     
  18 |     
  19 |     
  20 |     
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(integer_x,integer_x)::integer   from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key,covar_samp(integer_x,integer_x)::integer   from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
--bigint
select key, avg(bigint_x)::bigint            from strom_overflow_test  group by key order by key;
 key |         avg          
-----+----------------------
   1 |  9223372036854775807
   2 |  9223372036854775807
   3 |  9223372036854775807
   4 |  9223372036854775807
   5 |  9223372036854775807
   6 |  9223372036854775807
   7 |  9223372036854775807
   8 |  9223372036854775807
   9 |  9223372036854775807
  10 |  9223372036854775807
  11 | -9223372036854775808
  12 | -9223372036854775808
  13 | -9223372036854775808
  14 | -9223372036854775808
  15 | -9223372036854775808
  16 | -9223372036854775808
  17 | -9223372036854775808
  18 | -9223372036854775808
  19 | -9223372036854775808
  20 | -9223372036854775808
  21 |    66989324642380493
  22 |    94286572734972522
  23 |   -97262346713984870
  24 |    16218745252535229
  25 |    32203385185285704
  26 |   123754971303998041
  27 |    83948396317637957
  28 |   350630618203213445
  29 |   -92961276807414792
  30 |    47906039123235720
     |                     
(31 rows)

select key, count(bigint_x)::bigint           from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   954
   2 |   955
   3 |   950
   4 |   947
   5 |   925
   6 |   955
   7 |   951
   8 |   956
   9 |   954
  10 |   955
  11 |   961
  12 |   939
  13 |   944
  14 |   946
  15 |   942
  16 |   951
  17 |   952
  18 |   946
  19 |   942
  20 |   955
  21 |   954
  22 |   955
  23 |   956
  24 |   946
  25 |   955
  26 |   947
  27 |   937
  28 |   952
  29 |   953
  30 |   947
     |     0
(31 rows)

select key, max(bigint_x)::bigint             from strom_overflow_test  group by key order by key;
 key |         max          
-----+----------------------
   1 |  9223372036854775807
   2 |  9223372036854775807
   3 |  9223372036854775807
   4 |  9223372036854775807
   5 |  9223372036854775807
   6 |  9223372036854775807
   7 |  9223372036854775807
   8 |  9223372036854775807
   9 |  9223372036854775807
  10 |  9223372036854775807
  11 | -9223372036854775808
  12 | -9223372036854775808
  13 | -9223372036854775808
  14 | -9223372036854775808
  15 | -9223372036854775808
  16 | -9223372036854775808
  17 | -9223372036854775808
  18 | -9223372036854775808
  19 | -9223372036854775808
  20 | -9223372036854775808
  21 |  9220162296125325312
  22 |  9219174101459927040
  23 |  9201628653249626112
  24 |  9185004277955821568
  25 |  9176085305919275008
  26 |  9211608061301489664
  27 |  9213251135400312832
  28 |  9190417843714260992
  29 |  9201115559276576768
  30 |  9214073183550832640
     |                     
(31 rows)

select key, min(bigint_x)::bigint             from strom_overflow_test  group by key order by key;
 key |         min          
-----+----------------------
   1 |  9223372036854775807
   2 |  9223372036854775807
   3 |  9223372036854775807
   4 |  9223372036854775807
   5 |  9223372036854775807
   6 |  9223372036854775807
   7 |  9223372036854775807
   8 |  9223372036854775807
   9 |  9223372036854775807
  10 |  9223372036854775807
  11 | -9223372036854775808
  12 | -9223372036854775808
  13 | -9223372036854775808
  14 | -9223372036854775808
  15 | -9223372036854775808
  16 | -9223372036854775808
  17 | -9223372036854775808
  18 | -9223372036854775808
  19 | -9223372036854775808
  20 | -9223372036854775808
  21 | -9216335188206813184
  22 | -9199068071057162240
  23 | -9219976753538138112
  24 | -9218264831113560064
  25 | -9208358128268083200
  26 | -9198277608096137216
  27 | -9207328736276381696
  28 | -9219276063983534080
  29 | -9186497595134967808
  30 | -9215032782323974144
     |                     
(31 rows)

select key, sum(bigint_x)::bigint             from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, stddev(bigint_x)::bigint          from strom_overflow_test  group by key order by key;
 key |       stddev        
-----+---------------------
   1 |                   0
   2 |                   0
   3 |                   0
   4 |                   0
   5 |                   0
   6 |                   0
   7 |                   0
   8 |                   0
   9 |                   0
  10 |                   0
  11 |                   0
  12 |                   0
  13 |                   0
  14 |                   0
  15 |                   0
  16 |                   0
  17 |                   0
  18 |                   0
  19 |                   0
  20 |                   0
  21 | 5448498986731858885
  22 | 5283734691062960095
  23 | 5358488292557681770
  24 | 5352751044444989539
  25 | 5264620094694969619
  26 | 5202316800639032596
  27 | 5232482599682249677
  28 | 5287206495124930408
  29 | 5357550981574964850
  30 | 5231728491633125915
     |                    
(31 rows)

select key, stddev_pop(bigint_x)::bigint      from strom_overflow_test  group by key order by key;
 key |     stddev_pop      
-----+---------------------
   1 |                   0
   2 |                   0
   3 |                   0
   4 |                   0
   5 |                   0
   6 |                   0
   7 |                   0
   8 |                   0
   9 |                   0
  10 |                   0
  11 |                   0
  12 |                   0
  13 |                   0
  14 |                   0
  15 |                   0
  16 |                   0
  17 |                   0
  18 |                   0
  19 |                   0
  20 |                   0
  21 | 5445642630579204289
  22 | 5280967613265926491
  23 | 5355685002649605148
  24 | 5349921146787800984
  25 | 5261863027161187610
  26 | 5199569339765790524
  27 | 5229689707783415678
  28 | 5284428871347664524
  29 | 5354739356620593482
  30 | 5228965497782305039
     |                    
(31 rows)

select key, stddev_samp(bigint_x)::bigint     from strom_overflow_test  group by key order by key;
 key |     stddev_samp     
-----+---------------------
   1 |                   0
   2 |                   0
   3 |                   0
   4 |                   0
   5 |                   0
   6 |                   0
   7 |                   0
   8 |                   0
   9 |                   0
  10 |                   0
  11 |                   0
  12 |                   0
  13 |                   0
  14 |                   0
  15 |                   0
  16 |                   0
  17 |                   0
  18 |                   0
  19 |                   0
  20 |                   0
  21 | 5448498986731858885
  22 | 5283734691062960095
  23 | 5358488292557681770
  24 | 5352751044444989539
  25 | 5264620094694969619
  26 | 5202316800639032596
  27 | 5232482599682249677
  28 | 5287206495124930408
  29 | 5357550981574964850
  30 | 5231728491633125915
     |                    
(31 rows)

select key, variance(bigint_x)::bigint        from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, var_pop(bigint_x)::bigint         from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, var_samp(bigint_x)::bigint        from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key,corr(bigint_x,bigint_x)::bigint  from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |     
   2 |     
   3 |     
   4 |     
   5 |     
   6 |     
   7 |     
   8 |     
   9 |     
  10 |     
  11 |     
  12 |     
  13 |     
  14 |     
  15 |     
  16 |     
  17 |     
  18 |     
  19 |     
  20 |     
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(bigint_x,bigint_x)::bigint  from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key,covar_samp(bigint_x,bigint_x)::bigint from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
--real
select key, avg(real_x)::real            from strom_overflow_test  group by key order by key;
 key |     avg      
-----+--------------
   1 |        1e+38
   2 |        1e+38
   3 |        1e+38
   4 |        1e+38
   5 |        1e+38
   6 |        1e+38
   7 |        1e+38
   8 |        1e+38
   9 |        1e+38
  10 |        1e+38
  11 |       -1e+38
  12 |       -1e+38
  13 |       -1e+38
  14 |       -1e+38
  15 |       -1e+38
  16 |       -1e+38
  17 |       -1e+38
  18 |       -1e+38
  19 |       -1e+38
  20 |       -1e+38
  21 | -1.34906e+36
  22 | -2.35014e+35
  23 | -5.48249e+35
  24 | -1.08084e+36
  25 |  3.87356e+35
  26 |  3.38282e+35
  27 |  1.79019e+36
  28 |  2.01509e+36
  29 |  1.89653e+36
  30 |  1.14087e+36
     |             
(31 rows)

select key, count(real_x)::real           from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   947
   2 |   946
   3 |   948
   4 |   955
   5 |   949
   6 |   952
   7 |   947
   8 |   946
   9 |   951
  10 |   956
  11 |   953
  12 |   941
  13 |   949
  14 |   955
  15 |   942
  16 |   945
  17 |   944
  18 |   945
  19 |   952
  20 |   948
  21 |   943
  22 |   945
  23 |   941
  24 |   939
  25 |   949
  26 |   938
  27 |   936
  28 |   949
  29 |   956
  30 |   953
     |     0
(31 rows)

select key, max(real_x)::real             from strom_overflow_test  group by key order by key;
 key |     max     
-----+-------------
   1 |       1e+38
   2 |       1e+38
   3 |       1e+38
   4 |       1e+38
   5 |       1e+38
   6 |       1e+38
   7 |       1e+38
   8 |       1e+38
   9 |       1e+38
  10 |       1e+38
  11 |      -1e+38
  12 |      -1e+38
  13 |      -1e+38
  14 |      -1e+38
  15 |      -1e+38
  16 |      -1e+38
  17 |      -1e+38
  18 |      -1e+38
  19 |      -1e+38
  20 |      -1e+38
  21 | 9.97806e+37
  22 | 9.99283e+37
  23 | 9.95498e+37
  24 | 9.94817e+37
  25 | 9.98492e+37
  26 | 9.97683e+37
  27 | 9.94521e+37
  28 | 9.98919e+37
  29 | 9.99772e+37
  30 | 9.98589e+37
     |            
(31 rows)

select key, min(real_x)::real             from strom_overflow_test  group by key order by key;
 key |     min      
-----+--------------
   1 |        1e+38
   2 |        1e+38
   3 |        1e+38
   4 |        1e+38
   5 |        1e+38
   6 |        1e+38
   7 |        1e+38
   8 |        1e+38
   9 |        1e+38
  10 |        1e+38
  11 |       -1e+38
  12 |       -1e+38
  13 |       -1e+38
  14 |       -1e+38
  15 |       -1e+38
  16 |       -1e+38
  17 |       -1e+38
  18 |       -1e+38
  19 |       -1e+38
  20 |       -1e+38
  21 | -9.98908e+37
  22 | -9.98593e+37
  23 | -9.96371e+37
  24 | -9.99338e+37
  25 | -9.98024e+37
  26 | -9.99901e+37
  27 | -9.99594e+37
  28 | -9.98172e+37
  29 | -9.99905e+37
  30 | -9.98754e+37
     |             
(31 rows)

select key, sum(real_x)::real             from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
-- select key, stddev(real_x)::real          from strom_overflow_test  group by key order by key;
-- select key, stddev_pop(real_x)::real      from strom_overflow_test  group by key order by key;
-- select key, stddev_samp(real_x)::real     from strom_overflow_test  group by key order by key;
select key, variance(real_x)::real        from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key, var_pop(real_x)::real         from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key, var_samp(real_x)::real        from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
-- select key,corr(real_x,real_x)::real  from strom_overflow_test  group by key order by key;
select key,covar_pop(real_x,real_x)::real  from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key,covar_samp(real_x,real_x)::real  from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
--float
select key, avg(float_x)::float            from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key, count(float_x)::float           from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   947
   2 |   948
   3 |   946
   4 |   959
   5 |   965
   6 |   946
   7 |   959
   8 |   957
   9 |   944
  10 |   942
  11 |   945
  12 |   936
  13 |   941
  14 |   962
  15 |   958
  16 |   950
  17 |   951
  18 |   939
  19 |   958
  20 |   951
  21 |   947
  22 |   947
  23 |   943
  24 |   944
  25 |   953
  26 |   950
  27 |   954
  28 |   959
  29 |   937
  30 |   954
     |     0
(31 rows)

select key, max(float_x)::float             from strom_overflow_test  group by key order by key;
 key |          max          
-----+-----------------------
   1 |                1e+308
   2 |                1e+308
   3 |                1e+308
   4 |                1e+308
   5 |                1e+308
   6 |                1e+308
   7 |                1e+308
   8 |                1e+308
   9 |                1e+308
  10 |                1e+308
  11 |               -1e+308
  12 |               -1e+308
  13 |               -1e+308
  14 |               -1e+308
  15 |               -1e+308
  16 |               -1e+308
  17 |               -1e+308
  18 |               -1e+308
  19 |               -1e+308
  20 |               -1e+308
  21 | 9.99527945183218e+307
  22 | 9.98813641257584e+307
  23 | 9.97960691340268e+307
  24 | 9.93206185288727e+307
  25 | 9.99703846871853e+307
  26 | 9.97420649044216e+307
  27 | 9.97632752172649e+307
  28 | 9.98502329923213e+307
  29 | 9.95182529091835e+307
  30 | 9.92153377272189e+307
     |                      
(31 rows)

select key, min(float_x)::float             from strom_overflow_test  group by key order by key;
 key |          min           
-----+------------------------
   1 |                 1e+308
   2 |                 1e+308
   3 |                 1e+308
   4 |                 1e+308
   5 |                 1e+308
   6 |                 1e+308
   7 |                 1e+308
   8 |                 1e+308
   9 |                 1e+308
  10 |                 1e+308
  11 |                -1e+308
  12 |                -1e+308
  13 |                -1e+308
  14 |                -1e+308
  15 |                -1e+308
  16 |                -1e+308
  17 |                -1e+308
  18 |                -1e+308
  19 |                -1e+308
  20 |                -1e+308
  21 | -9.96138229034841e+307
  22 | -9.99781461432576e+307
  23 | -9.96753358282149e+307
  24 | -9.90648711100221e+307
  25 | -9.98455223627388e+307
  26 | -9.99770946800709e+307
  27 | -9.98397724702954e+307
  28 | -9.99285292811692e+307
  29 | -9.99192949384451e+307
  30 | -9.99421687796712e+307
     |                       
(31 rows)

select key, sum(float_x)::float             from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
-- select key, stddev(float_x)::float          from strom_overflow_test  group by key order by key;
-- select key, stddev_pop(float_x)::float      from strom_overflow_test  group by key order by key;
-- select key, stddev_samp(float_x)::float     from strom_overflow_test  group by key order by key;
select key, variance(float_x)::float        from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key, var_pop(float_x)::float         from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key, var_samp(float_x)::float        from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
-- select key,corr(float_x,float_x)::float  from strom_overflow_test  group by key order by key;
select key,covar_pop(float_x,float_x)::float  from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
select key,covar_samp(float_x,float_x)::float  from strom_overflow_test  group by key order by key;
ERROR:  value out of range: overflow
--numeric
select key, avg(nume_x)::numeric            from strom_overflow_test  group by key order by key;
 key |          avg           
-----+------------------------
   1 |  515716923479843518924
   2 |  502341317491815902856
   3 |  501193501862031534418
   4 |  507143516018058283956
   5 |  509238207004260723027
   6 |  493646084727450534689
   7 |  499934628217219050706
   8 |  483939450056919846625
   9 |  497958192675805990888
  10 |  505695189356659722806
  11 | -513103473653241736072
  12 | -491961015124999744655
  13 | -498048986370755320855
  14 | -481092027615210156955
  15 | -484012016776293603287
  16 | -507140764692400658170
  17 | -488893180555662014799
  18 | -486092542547337771278
  19 | -503169876891593683532
  20 | -487448972250523539662
  21 |   13658791356784215472
  22 |    5833937410089677910
  23 |   14930652074885593116
  24 |  -16920390620325220611
  25 |  -26435570768957418906
  26 |   -5160731501160307213
  27 |    9012232026593257327
  28 |  -14143354979536244873
  29 |   -7520335842126147591
  30 |   -8517869112603815174
     |                       
(31 rows)

select key, count(nume_x)::numeric           from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |   948
   2 |   949
   3 |   961
   4 |   963
   5 |   953
   6 |   949
   7 |   949
   8 |   951
   9 |   969
  10 |   956
  11 |   942
  12 |   953
  13 |   954
  14 |   949
  15 |   949
  16 |   951
  17 |   942
  18 |   953
  19 |   942
  20 |   948
  21 |   943
  22 |   955
  23 |   947
  24 |   949
  25 |   956
  26 |   956
  27 |   946
  28 |   948
  29 |   958
  30 |   951
     |     0
(31 rows)

select key, max(nume_x)::numeric             from strom_overflow_test  group by key order by key;
 key |          max          
-----+-----------------------
   1 | 999388808384538000000
   2 | 998365372885019000000
   3 | 998141053598374000000
   4 | 997452890966088000000
   5 | 999555916059762000000
   6 | 999441923573613000000
   7 | 994858962483704000000
   8 | 999286246951669000000
   9 | 999658957589418000000
  10 | 999781834892929000000
  11 |  -3429549746215340000
  12 |   -645105727016926000
  13 |   -102209392935038000
  14 |  -2406653016805650000
  15 |   -771359540522099000
  16 |   -193603336811066000
  17 |   -865468289703131000
  18 |   -259240623563528000
  19 |   -385569408535957000
  20 |  -1600239891558890000
  21 | 999464837834239000000
  22 | 998341543599963000000
  23 | 999783226288855000000
  24 | 998303121887147000000
  25 | 994687485508621000000
  26 | 998084946535528000000
  27 | 997576954774559000000
  28 | 997090246528387000000
  29 | 998657686635852000000
  30 | 996714174747467000000
     |                      
(31 rows)

select key, min(nume_x)::numeric             from strom_overflow_test  group by key order by key;
 key |          min           
-----+------------------------
   1 |     454584602266550000
   2 |    2070697955787180000
   3 |     574419274926186000
   4 |    1087001990526910000
   5 |     345914624631405000
   6 |    1686217729002240000
   7 |     388656277209520000
   8 |    2247432712465520000
   9 |    3487716894596820000
  10 |     123612582683563000
  11 | -996445819269866000000
  12 | -999781885650009000000
  13 | -997943399474025000000
  14 | -999686059542000000000
  15 | -999861691612750000000
  16 | -998231015633792000000
  17 | -999183408450335000000
  18 | -999446763191372000000
  19 | -999826832674444000000
  20 | -999351024627686000000
  21 | -993244011886418000000
  22 | -999487617053092000000
  23 | -999046324752271000000
  24 | -999738717451692000000
  25 | -998808633536100000000
  26 | -999516472220421000000
  27 | -999852304346859000000
  28 | -997943937778473000000
  29 | -999124299734831000000
  30 | -995574958622456000000
     |                       
(31 rows)

select key, sum(nume_x)::numeric             from strom_overflow_test  group by key order by key;
 key |            sum            
-----+---------------------------
   1 |  488899643458891655940000
   2 |  476721910299733291810000
   3 |  481646955289412304576000
   4 |  488379205925390127450000
   5 |  485304011275060469045000
   6 |  468470134406350557420000
   7 |  474437962178140879120000
   8 |  460226417004130774140000
   9 |  482521488702856005170000
  10 |  483444601024966695003000
  11 | -483343472181353715380000
  12 | -468838847414124756656000
  13 | -475138732997700576096000
  14 | -456556334206834438950000
  15 | -459327403920702629519000
  16 | -482290867222473025920000
  17 | -460537376083433617941000
  18 | -463246193047612896028000
  19 | -473986024031881249887000
  20 | -462101625693496315600000
  21 |   12880240249447515190000
  22 |    5571410226635642404000
  23 |   14139327514916656681000
  24 |  -16057450698688634360000
  25 |  -25272405655123292474220
  26 |   -4933659315109253696000
  27 |    8525571497157221431000
  28 |  -13407900520600360140000
  29 |   -7204481736756849392000
  30 |   -8100493526086228230000
     |                          
(31 rows)

select key, stddev(nume_x)::numeric          from strom_overflow_test  group by key order by key;
 key |        stddev         
-----+-----------------------
   1 | 286153695171655167908
   2 | 293119141198330183803
   3 | 284549020267704666403
   4 | 291553051750776471710
   5 | 284183913219184671938
   6 | 284154639550126256383
   7 | 289283601157850339030
   8 | 286227064720390615669
   9 | 297374184171785165445
  10 | 290863204242095264894
  11 | 282179098962213774953
  12 | 284738928590993748240
  13 | 291425753663617965722
  14 | 282301425822338438300
  15 | 289828396382687893231
  16 | 288290816419779653811
  17 | 289593929135411672265
  18 | 288310212875989292353
  19 | 291159818517044761824
  20 | 280411005487668747573
  21 | 576563500465354083392
  22 | 568354513692288817013
  23 | 575345375306351463111
  24 | 584088017201718999578
  25 | 567727432369556075196
  26 | 579964107899049123636
  27 | 578148875943810874308
  28 | 597766239521758494401
  29 | 572429496730485131825
  30 | 572791333897912877097
     |                      
(31 rows)

select key, stddev_pop(nume_x)::numeric      from strom_overflow_test  group by key order by key;
 key |      stddev_pop       
-----+-----------------------
   1 | 286002730405056459031
   2 | 292964664696851221344
   3 | 284400933335859846733
   4 | 291401634938823576965
   5 | 284034774445743998345
   6 | 284004887424020582662
   7 | 289131146021486986359
   8 | 286076537723537522343
   9 | 297220700711665828139
  10 | 290711039332783966255
  11 | 282029282599669116913
  12 | 284589498547330018484
  13 | 291272974752114784722
  14 | 282152650357026703474
  15 | 289675654134196648485
  16 | 288139204094584661834
  17 | 289440176043004595748
  18 | 288158908634198586308
  19 | 291005234052462473324
  20 | 280263070365007614862
  21 | 576257712323736043941
  22 | 568056867945930311220
  23 | 575041522433135282887
  24 | 583780197408428681362
  25 | 567430426106817712038
  26 | 579660700026911356016
  27 | 577843219630645047003
  28 | 597450878782573012711
  29 | 572130655939180696468
  30 | 572490102568166483735
     |                      
(31 rows)

select key, stddev_samp(nume_x)::numeric     from strom_overflow_test  group by key order by key;
 key |      stddev_samp      
-----+-----------------------
   1 | 286153695171655167908
   2 | 293119141198330183803
   3 | 284549020267704666403
   4 | 291553051750776471710
   5 | 284183913219184671938
   6 | 284154639550126256383
   7 | 289283601157850339030
   8 | 286227064720390615669
   9 | 297374184171785165445
  10 | 290863204242095264894
  11 | 282179098962213774953
  12 | 284738928590993748240
  13 | 291425753663617965722
  14 | 282301425822338438300
  15 | 289828396382687893231
  16 | 288290816419779653811
  17 | 289593929135411672265
  18 | 288310212875989292353
  19 | 291159818517044761824
  20 | 280411005487668747573
  21 | 576563500465354083392
  22 | 568354513692288817013
  23 | 575345375306351463111
  24 | 584088017201718999578
  25 | 567727432369556075196
  26 | 579964107899049123636
  27 | 578148875943810874308
  28 | 597766239521758494401
  29 | 572429496730485131825
  30 | 572791333897912877097
     |                      
(31 rows)

select key, variance(nume_x)::numeric        from strom_overflow_test  group by key order by key;
 key |                  variance                  
-----+--------------------------------------------
   1 |  81883937260392546154837281160098523656316
   2 |  85918830936846627260963730614366263672175
   3 |  80968144935310601020549193643138458412331
   4 |  85003181985190943455726413759320828093730
   5 |  80760496532569084530234023194488183919423
   6 |  80743859177862176876497783981783163326264
   7 |  83685001898854230012079875483349621547443
   8 |  81925932578450678230872696896256802384194
   9 |  88431405411834802824600540536841325657788
  10 |  84601403581978824899418897893465499601256
  11 |  79625043891126835124498626692340162664284
  12 |  81076257455147037006144139624919843327123
  13 |  84928969898407740170154808330407531307490
  14 |  79694095021325251604918679750585293986341
  15 |  84000499349760452673940451797514973575992
  16 |  83111594831983094051239771078380317272004
  17 |  83864643792085837425693936640900725338023
  18 |  83122778848598261943686355399897065553899
  19 |  84774039918878441768618723977127669584001
  20 |  78630331998605392465824674926915570107691
  21 | 332425470068862358335850941932192765143318
  22 | 323026853234398116376992018645434411828360
  23 | 331022300886406419945092334961594512246536
  24 | 341158811838635589950315911235168812307512
  25 | 322314437464928867238090346599605416250698
  26 | 336358366451139894085860598299042168787925
  27 | 334256122755092016278523738931660363259332
  28 | 357324477111984347001316899989080333352492
  29 | 327675528727116488225396588179757950327690
  30 | 328089912188550317387287722448894365838287
     |                                           
(31 rows)

select key, var_pop(nume_x)::numeric         from strom_overflow_test  group by key order by key;
 key |                  var_pop                   
-----+--------------------------------------------
   1 |  81797561799147406338218254492208124369759
   2 |  85828294760938464323913189275468090580845
   3 |  80883890882308196649039777208546222763619
   4 |  84914912845019405612054839082519871885948
   5 |  80675753094444667862311427157557975961480
   6 |  80658776080730604508872391164099514049840
   7 |  83596819599698429980454923032892983379321
   8 |  81839785435886587086571043166607741603559
   9 |  88340144931533631717454409948052015724189
  10 |  84512908389947466295967622895668987572385
  11 |  79540516243684025320757120719206043595638
  12 |  80991182683420754700786170957947209703485
  13 |  84839945820946096836643115659201653392073
  14 |  79610118103494561139581568391522506532194
  15 |  83911984598074719847097521922069752318272
  16 |  83024200936260714351921958490495585077186
  17 |  83775615507805491526091289149774503761231
  18 |  83035556625252408573336212319729282693926
  19 |  84684046245928464654214670130018192227754
  20 |  78547388610421209562379712189650891236269
  21 | 332072951012585728051295426617312391055149
  22 | 322688605220540107878167943233240239669377
  23 | 330672752522218028794147147701867379709845
  24 | 340799318886223961299156463488872533263985
  25 | 321977288471764715703322469668015870836210
  26 | 336006527155688910933051120685758651874967
  27 | 333902786473109889411421705380992646173434
  28 | 356947552558068751698572894820315480680179
  29 | 327333487465397159949587197169131898187473
  30 | 327744917538509780775944622845898683014061
     |                                           
(31 rows)

select key, var_samp(nume_x)::numeric        from strom_overflow_test  group by key order by key;
 key |                  var_samp                  
-----+--------------------------------------------
   1 |  81883937260392546154837281160098523656316
   2 |  85918830936846627260963730614366263672175
   3 |  80968144935310601020549193643138458412331
   4 |  85003181985190943455726413759320828093730
   5 |  80760496532569084530234023194488183919423
   6 |  80743859177862176876497783981783163326264
   7 |  83685001898854230012079875483349621547443
   8 |  81925932578450678230872696896256802384194
   9 |  88431405411834802824600540536841325657788
  10 |  84601403581978824899418897893465499601256
  11 |  79625043891126835124498626692340162664284
  12 |  81076257455147037006144139624919843327123
  13 |  84928969898407740170154808330407531307490
  14 |  79694095021325251604918679750585293986341
  15 |  84000499349760452673940451797514973575992
  16 |  83111594831983094051239771078380317272004
  17 |  83864643792085837425693936640900725338023
  18 |  83122778848598261943686355399897065553899
  19 |  84774039918878441768618723977127669584001
  20 |  78630331998605392465824674926915570107691
  21 | 332425470068862358335850941932192765143318
  22 | 323026853234398116376992018645434411828360
  23 | 331022300886406419945092334961594512246536
  24 | 341158811838635589950315911235168812307512
  25 | 322314437464928867238090346599605416250698
  26 | 336358366451139894085860598299042168787925
  27 | 334256122755092016278523738931660363259332
  28 | 357324477111984347001316899989080333352492
  29 | 327675528727116488225396588179757950327690
  30 | 328089912188550317387287722448894365838287
     |                                           
(31 rows)

select key,round(corr(nume_x,nume_x)::numeric,14)  from strom_overflow_test  group by key order by key;
 key |      round       
-----+------------------
   1 | 1.00000000000000
   2 | 1.00000000000000
   3 | 1.00000000000000
   4 | 1.00000000000000
   5 | 1.00000000000000
   6 | 1.00000000000000
   7 | 1.00000000000000
   8 | 1.00000000000000
   9 | 1.00000000000000
  10 | 1.00000000000000
  11 | 1.00000000000000
  12 | 1.00000000000000
  13 | 1.00000000000000
  14 | 1.00000000000000
  15 | 1.00000000000000
  16 | 1.00000000000000
  17 | 1.00000000000000
  18 | 1.00000000000000
  19 | 1.00000000000000
  20 | 1.00000000000000
  21 | 1.00000000000000
  22 | 1.00000000000000
  23 | 1.00000000000000
  24 | 1.00000000000000
  25 | 1.00000000000000
  26 | 1.00000000000000
  27 | 1.00000000000000
  28 | 1.00000000000000
  29 | 1.00000000000000
  30 | 1.00000000000000
     |                 
(31 rows)

select key,trunc(covar_pop(nume_x,nume_x)::numeric*1e-42,13)  from strom_overflow_test  group by key order by key;
 key |      trunc      
-----+-----------------
   1 | 0.0817975617991
   2 | 0.0858282947609
   3 | 0.0808838908823
   4 | 0.0849149128450
   5 | 0.0806757530944
   6 | 0.0806587760807
   7 | 0.0835968195996
   8 | 0.0818397854358
   9 | 0.0883401449315
  10 | 0.0845129083899
  11 | 0.0795405162436
  12 | 0.0809911826834
  13 | 0.0848399458209
  14 | 0.0796101181034
  15 | 0.0839119845980
  16 | 0.0830242009362
  17 | 0.0837756155078
  18 | 0.0830355566252
  19 | 0.0846840462459
  20 | 0.0785473886104
  21 | 0.3320729510125
  22 | 0.3226886052205
  23 | 0.3306727525222
  24 | 0.3407993188862
  25 | 0.3219772884717
  26 | 0.3360065271556
  27 | 0.3339027864731
  28 | 0.3569475525580
  29 | 0.3273334874653
  30 | 0.3277449175385
     |                
(31 rows)

select key,trunc(covar_samp(nume_x,nume_x)::numeric*1e-42,13)  from strom_overflow_test  group by key order by key;
 key |      trunc      
-----+-----------------
   1 | 0.0818839372603
   2 | 0.0859188309368
   3 | 0.0809681449353
   4 | 0.0850031819851
   5 | 0.0807604965325
   6 | 0.0807438591778
   7 | 0.0836850018988
   8 | 0.0819259325784
   9 | 0.0884314054118
  10 | 0.0846014035819
  11 | 0.0796250438911
  12 | 0.0810762574551
  13 | 0.0849289698984
  14 | 0.0796940950213
  15 | 0.0840004993497
  16 | 0.0831115948319
  17 | 0.0838646437920
  18 | 0.0831227788485
  19 | 0.0847740399188
  20 | 0.0786303319986
  21 | 0.3324254700688
  22 | 0.3230268532343
  23 | 0.3310223008864
  24 | 0.3411588118386
  25 | 0.3223144374649
  26 | 0.3363583664511
  27 | 0.3342561227550
  28 | 0.3573244771119
  29 | 0.3276755287271
  30 | 0.3280899121885
     |                
(31 rows)

--smallserial
select key, avg(smlsrl_x)::smallint            from strom_overflow_test  group by key order by key;
 key |  avg   
-----+--------
   1 |  16253
   2 |  16424
   3 |  16236
   4 |  16051
   5 |  16647
   6 |  16279
   7 |  15520
   8 |  16564
   9 |  16543
  10 |  16838
  11 | -16197
  12 | -16189
  13 | -16361
  14 | -16273
  15 | -16279
  16 | -16684
  17 | -15896
  18 | -16291
  19 | -16276
  20 | -16199
  21 |   -947
  22 |   -157
  23 |    753
  24 |    104
  25 |     38
  26 |    567
  27 |    177
  28 |    481
  29 |   -125
  30 |  -1124
     |      0
(31 rows)

select key, count(smlsrl_x)::smallint              from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |  1000
   2 |  1000
   3 |  1000
   4 |  1000
   5 |  1000
   6 |  1000
   7 |  1000
   8 |  1000
   9 |  1000
  10 |  1000
  11 |  1000
  12 |  1000
  13 |  1000
  14 |  1000
  15 |  1000
  16 |  1000
  17 |  1000
  18 |  1000
  19 |  1000
  20 |  1000
  21 |  1000
  22 |  1000
  23 |  1000
  24 |  1000
  25 |  1000
  26 |  1000
  27 |  1000
  28 |  1000
  29 |  1000
  30 |  1000
     | 10000
(31 rows)

select key, max(smlsrl_x)::smallint                from strom_overflow_test  group by key order by key;
 key |  max  
-----+-------
   1 | 32740
   2 | 32727
   3 | 32685
   4 | 32726
   5 | 32750
   6 | 32764
   7 | 32747
   8 | 32756
   9 | 32743
  10 | 32759
  11 |   -32
  12 |   -76
  13 |   -41
  14 |   -25
  15 |   -21
  16 |    -8
  17 |    -5
  18 |   -16
  19 |   -23
  20 |   -78
  21 | 32730
  22 | 32699
  23 | 32757
  24 | 32738
  25 | 32663
  26 | 32627
  27 | 32744
  28 | 32376
  29 | 32705
  30 | 32532
     |     0
(31 rows)

select key, min(smlsrl_x)::smallint                from strom_overflow_test  group by key order by key;
 key |  min   
-----+--------
   1 |     17
   2 |     15
   3 |     79
   4 |      1
   5 |      7
   6 |      6
   7 |     33
   8 |     76
   9 |     41
  10 |     29
  11 | -32725
  12 | -32716
  13 | -32766
  14 | -32756
  15 | -32761
  16 | -32713
  17 | -32659
  18 | -32742
  19 | -32750
  20 | -32763
  21 | -32723
  22 | -32624
  23 | -32646
  24 | -32732
  25 | -32664
  26 | -32473
  27 | -32743
  28 | -32710
  29 | -32700
  30 | -32661
     |      0
(31 rows)

select key, sum(smlsrl_x)::smallint                from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, stddev(smlsrl_x)::smallint             from strom_overflow_test  group by key order by key;
 key | stddev 
-----+--------
   1 |   9428
   2 |   9273
   3 |   9506
   4 |   9299
   5 |   9549
   6 |   9511
   7 |   9491
   8 |   9550
   9 |   9405
  10 |   9600
  11 |   9237
  12 |   9355
  13 |   9438
  14 |   9652
  15 |   9502
  16 |   9402
  17 |   9503
  18 |   9625
  19 |   9359
  20 |   9279
  21 |  18663
  22 |  18776
  23 |  18932
  24 |  19028
  25 |  19000
  26 |  18630
  27 |  18763
  28 |  18697
  29 |  18916
  30 |  18742
     |      0
(31 rows)

select key, stddev_pop(smlsrl_x)::smallint         from strom_overflow_test  group by key order by key;
 key | stddev_pop 
-----+------------
   1 |       9423
   2 |       9269
   3 |       9501
   4 |       9295
   5 |       9544
   6 |       9507
   7 |       9486
   8 |       9545
   9 |       9400
  10 |       9596
  11 |       9233
  12 |       9351
  13 |       9433
  14 |       9647
  15 |       9497
  16 |       9397
  17 |       9498
  18 |       9620
  19 |       9355
  20 |       9275
  21 |      18653
  22 |      18766
  23 |      18922
  24 |      19018
  25 |      18991
  26 |      18621
  27 |      18754
  28 |      18688
  29 |      18907
  30 |      18733
     |          0
(31 rows)

select key, stddev_samp(smlsrl_x)::smallint        from strom_overflow_test  group by key order by key;
 key | stddev_samp 
-----+-------------
   1 |        9428
   2 |        9273
   3 |        9506
   4 |        9299
   5 |        9549
   6 |        9511
   7 |        9491
   8 |        9550
   9 |        9405
  10 |        9600
  11 |        9237
  12 |        9355
  13 |        9438
  14 |        9652
  15 |        9502
  16 |        9402
  17 |        9503
  18 |        9625
  19 |        9359
  20 |        9279
  21 |       18663
  22 |       18776
  23 |       18932
  24 |       19028
  25 |       19000
  26 |       18630
  27 |       18763
  28 |       18697
  29 |       18916
  30 |       18742
     |           0
(31 rows)

select key, variance(smlsrl_x)::smallint           from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, var_pop(smlsrl_x)::smallint            from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key, var_samp(smlsrl_x)::smallint           from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key,corr(smlsrl_x,smlsrl_x)::smallint     from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |    1
   2 |    1
   3 |    1
   4 |    1
   5 |    1
   6 |    1
   7 |    1
   8 |    1
   9 |    1
  10 |    1
  11 |    1
  12 |    1
  13 |    1
  14 |    1
  15 |    1
  16 |    1
  17 |    1
  18 |    1
  19 |    1
  20 |    1
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(smlsrl_x,smlsrl_x)::smallint     from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
select key,covar_samp(smlsrl_x,smlsrl_x)::smallint     from strom_overflow_test  group by key order by key;
ERROR:  smallint out of range
--serial
select key, avg(serial_x)::integer            from strom_overflow_test  group by key order by key;
 key |     avg     
-----+-------------
   1 |  1079725080
   2 |  1058852903
   3 |  1087272774
   4 |  1080915053
   5 |  1077784062
   6 |  1084101611
   7 |  1092983785
   8 |  1082766461
   9 |  1055912069
  10 |  1105077631
  11 | -1086782796
  12 | -1088663505
  13 | -1094538789
  14 | -1087923054
  15 | -1091865122
  16 | -1085049561
  17 | -1089988604
  18 | -1053951789
  19 | -1063061357
  20 | -1069809506
  21 |   -98406158
  22 |    14792060
  23 |   -16460688
  24 |    -5226126
  25 |   -12154227
  26 |    54438320
  27 |    39261498
  28 |    -8814225
  29 |   -15988634
  30 |    37967855
     |           0
(31 rows)

select key, count(serial_x)::integer           from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |  1000
   2 |  1000
   3 |  1000
   4 |  1000
   5 |  1000
   6 |  1000
   7 |  1000
   8 |  1000
   9 |  1000
  10 |  1000
  11 |  1000
  12 |  1000
  13 |  1000
  14 |  1000
  15 |  1000
  16 |  1000
  17 |  1000
  18 |  1000
  19 |  1000
  20 |  1000
  21 |  1000
  22 |  1000
  23 |  1000
  24 |  1000
  25 |  1000
  26 |  1000
  27 |  1000
  28 |  1000
  29 |  1000
  30 |  1000
     | 10000
(31 rows)

select key, max(serial_x)::integer                from strom_overflow_test  group by key order by key;
 key |    max     
-----+------------
   1 | 2147466241
   2 | 2146087101
   3 | 2145758062
   4 | 2143957513
   5 | 2142773996
   6 | 2144514314
   7 | 2145851067
   8 | 2145019633
   9 | 2145854097
  10 | 2144330002
  11 |    -752774
  12 |   -4165118
  13 |   -3336944
  14 |    -495443
  15 |   -7097165
  16 |   -6097537
  17 |   -3661803
  18 |   -8906139
  19 |   -1747177
  20 |  -14183983
  21 | 2146869371
  22 | 2135891717
  23 | 2147022451
  24 | 2145641011
  25 | 2146805573
  26 | 2139171163
  27 | 2147059053
  28 | 2139576319
  29 | 2140915373
  30 | 2140779911
     |          0
(31 rows)

select key, min(serial_x)::integer                from strom_overflow_test  group by key order by key;
 key |     min     
-----+-------------
   1 |     2073103
   2 |     2701149
   3 |     4147402
   4 |     6156462
   5 |     2736757
   6 |      810024
   7 |       56172
   8 |      960749
   9 |      812720
  10 |      556314
  11 | -2144094332
  12 | -2145779616
  13 | -2146759050
  14 | -2145862512
  15 | -2147108132
  16 | -2147115632
  17 | -2146962464
  18 | -2146409915
  19 | -2144978645
  20 | -2146953357
  21 | -2145754469
  22 | -2140086605
  23 | -2144184561
  24 | -2146281889
  25 | -2137368319
  26 | -2143908231
  27 | -2147401051
  28 | -2146537911
  29 | -2133603279
  30 | -2146242855
     |           0
(31 rows)

select key, sum(serial_x)::integer                from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, stddev(serial_x)::integer             from strom_overflow_test  group by key order by key;
 key |   stddev   
-----+------------
   1 |  606448544
   2 |  616503257
   3 |  632147551
   4 |  620868345
   5 |  623524734
   6 |  614054162
   7 |  631011744
   8 |  613387163
   9 |  622002334
  10 |  616433720
  11 |  617396057
  12 |  618816631
  13 |  606463658
  14 |  629867139
  15 |  625077653
  16 |  623480388
  17 |  616619704
  18 |  604231828
  19 |  629707129
  20 |  617951787
  21 | 1219569993
  22 | 1229129985
  23 | 1263215141
  24 | 1220445070
  25 | 1236532071
  26 | 1253355818
  27 | 1260265191
  28 | 1235074374
  29 | 1264851525
  30 | 1233901187
     |          0
(31 rows)

select key, stddev_pop(serial_x)::integer         from strom_overflow_test  group by key order by key;
 key | stddev_pop 
-----+------------
   1 |  606145243
   2 |  616194928
   3 |  631831399
   4 |  620557833
   5 |  623212894
   6 |  613747058
   7 |  630696159
   8 |  613080393
   9 |  621691255
  10 |  616125426
  11 |  617087282
  12 |  618507146
  13 |  606160350
  14 |  629552126
  15 |  624765036
  16 |  623168569
  17 |  616311317
  18 |  603929636
  19 |  629392197
  20 |  617642734
  21 | 1218960056
  22 | 1228515266
  23 | 1262583376
  24 | 1219834695
  25 | 1235913650
  26 | 1252728983
  27 | 1259634901
  28 | 1234456682
  29 | 1264218941
  30 | 1233284082
     |          0
(31 rows)

select key, stddev_samp(serial_x)::integer        from strom_overflow_test  group by key order by key;
 key | stddev_samp 
-----+-------------
   1 |   606448544
   2 |   616503257
   3 |   632147551
   4 |   620868345
   5 |   623524734
   6 |   614054162
   7 |   631011744
   8 |   613387163
   9 |   622002334
  10 |   616433720
  11 |   617396057
  12 |   618816631
  13 |   606463658
  14 |   629867139
  15 |   625077653
  16 |   623480388
  17 |   616619704
  18 |   604231828
  19 |   629707129
  20 |   617951787
  21 |  1219569993
  22 |  1229129985
  23 |  1263215141
  24 |  1220445070
  25 |  1236532071
  26 |  1253355818
  27 |  1260265191
  28 |  1235074374
  29 |  1264851525
  30 |  1233901187
     |           0
(31 rows)

select key, variance(serial_x)::integer           from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, var_pop(serial_x)::integer            from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key, var_samp(serial_x)::integer           from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key,corr(serial_x,serial_x)::integer     from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |    1
   2 |    1
   3 |    1
   4 |    1
   5 |    1
   6 |    1
   7 |    1
   8 |    1
   9 |    1
  10 |    1
  11 |    1
  12 |    1
  13 |    1
  14 |    1
  15 |    1
  16 |    1
  17 |    1
  18 |    1
  19 |    1
  20 |    1
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(serial_x,serial_x)::integer    from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
select key,covar_samp(serial_x,serial_x)::integer     from strom_overflow_test  group by key order by key;
ERROR:  integer out of range
--bigserial
select key, avg(bigsrl_x)::bigint            from strom_overflow_test  group by key order by key;
 key |         avg          
-----+----------------------
   1 |  4688898944238501233
   2 |  4724381544060205138
   3 |  4674810944070120112
   4 |  4665531486890025288
   5 |  4659655461348327817
   6 |  4593332997433499582
   7 |  4664779446843869233
   8 |  4665184440179455164
   9 |  4673236468596243169
  10 |  4543339468539148894
  11 | -4582339557584554426
  12 | -4596205916184668799
  13 | -4503403799947247616
  14 | -4696633927373613433
  15 | -4618607026679186457
  16 | -4517271238886255755
  17 | -4610568371510657942
  18 | -4687902965653548564
  19 | -4597164682438529516
  20 | -4498784517226890265
  21 |  -160859291544451023
  22 |   132910793632493076
  23 |  -241437678708516192
  24 |    17299042912872432
  25 |   156075231497544532
  26 |   -52583824224619069
  27 |   293399327914732814
  28 |  -334272240099553968
  29 |   200942474048013599
  30 |   295585147135146852
     |                    0
(31 rows)

select key, count(bigsrl_x)::bigint          from strom_overflow_test  group by key order by key;
 key | count 
-----+-------
   1 |  1000
   2 |  1000
   3 |  1000
   4 |  1000
   5 |  1000
   6 |  1000
   7 |  1000
   8 |  1000
   9 |  1000
  10 |  1000
  11 |  1000
  12 |  1000
  13 |  1000
  14 |  1000
  15 |  1000
  16 |  1000
  17 |  1000
  18 |  1000
  19 |  1000
  20 |  1000
  21 |  1000
  22 |  1000
  23 |  1000
  24 |  1000
  25 |  1000
  26 |  1000
  27 |  1000
  28 |  1000
  29 |  1000
  30 |  1000
     | 10000
(31 rows)

select key, max(bigsrl_x)::bigint            from strom_overflow_test  group by key order by key;
 key |         max         
-----+---------------------
   1 | 9203746523098120192
   2 | 9221999588645273600
   3 | 9222918415293874176
   4 | 9214452244479475712
   5 | 9220415974073696256
   6 | 9219408172882591744
   7 | 9202597765375328256
   8 | 9218459968657686528
   9 | 9220663621887983616
  10 | 9216684300328501248
  11 |  -21627561222078464
  12 |  -29362367825444864
  13 |  -11378626792521728
  14 |   -2666818208530432
  15 |   -8198740380745728
  16 |  -12907759703949312
  17 |   -2728781701709824
  18 |   -3287741630513152
  19 |    -960960277774336
  20 |   -2731156818624512
  21 | 9197871922665226240
  22 | 9195664129086455808
  23 | 9218788164288643072
  24 | 9223129809289216000
  25 | 9215191275207131136
  26 | 9196628624122314752
  27 | 9216379649708261376
  28 | 9219147120475373568
  29 | 9218100007448608768
  30 | 9173922025381560320
     |                   0
(31 rows)

select key, min(bigsrl_x)::bigint            from strom_overflow_test  group by key order by key;
 key |         min          
-----+----------------------
   1 |     8190296475041792
   2 |     6717449110028288
   3 |     5700770221522944
   4 |     3729040930242560
   5 |     5844501302083584
   6 |      989002119249920
   7 |      855269722554368
   8 |    24189006702968832
   9 |     5684492295471104
  10 |     5242239513001984
  11 | -9223266067126681600
  12 | -9215175048820686848
  13 | -9212377444563025920
  14 | -9222511991128588288
  15 | -9219893654510895104
  16 | -9221843015612497920
  17 | -9221378751122636800
  18 | -9220121738749149184
  19 | -9209323684160864256
  20 | -9192712627560644608
  21 | -9205298307667066880
  22 | -9219573773936623616
  23 | -9195169829890293760
  24 | -9216298156998787072
  25 | -9214889029768577024
  26 | -9206939371721195520
  27 | -9213880846325383168
  28 | -9211847342519484416
  29 | -9164760396282724352
  30 | -9191556911990833152
     |                    0
(31 rows)

select key, sum(bigsrl_x)::bigint            from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, stddev(bigsrl_x)::bigint         from strom_overflow_test  group by key order by key;
 key |       stddev        
-----+---------------------
   1 | 2608278721183613490
   2 | 2671917775328766763
   3 | 2667386919211443298
   4 | 2613289621770389332
   5 | 2660609917017003553
   6 | 2612142365440707752
   7 | 2695405583288260547
   8 | 2695431521329053805
   9 | 2657660608701103891
  10 | 2714542775263594419
  11 | 2643922144989386829
  12 | 2635062101573317824
  13 | 2602798467340843940
  14 | 2686796537962288567
  15 | 2639940094938097094
  16 | 2673263840743710611
  17 | 2671209799755162265
  18 | 2628121224411239138
  19 | 2640885518806306076
  20 | 2660489123859394241
  21 | 5279636141550424094
  22 | 5289777460091846726
  23 | 5275751118060349421
  24 | 5270442777150705130
  25 | 5388294458279664273
  26 | 5391310279324277415
  27 | 5417798802661513794
  28 | 5240610166507128356
  29 | 5207784549645024979
  30 | 5324626465407118214
     |                   0
(31 rows)

select key, stddev_pop(bigsrl_x)::bigint     from strom_overflow_test  group by key order by key;
 key |     stddev_pop      
-----+---------------------
   1 | 2606974255625062158
   2 | 2670581482284281157
   3 | 2666052892161656725
   4 | 2611982650134868662
   5 | 2659279279315863302
   6 | 2610835967576830711
   7 | 2694057543402350294
   8 | 2694083468470879278
   9 | 2656331446022969575
  10 | 2713185164388350679
  11 | 2642599853261275528
  12 | 2633744240974974083
  13 | 2601496742594588453
  14 | 2685452803675710367
  15 | 2638619794733016727
  16 | 2671926874498175175
  17 | 2669873860787004685
  18 | 2626806835119520157
  19 | 2639564745771054495
  20 | 2659158546569939493
  21 | 5276995663194947549
  22 | 5287131909808800424
  23 | 5273112582702488815
  24 | 5267806896627173939
  25 | 5385599637176738125
  26 | 5388613949933662723
  27 | 5415089225696508498
  28 | 5237989206019860988
  29 | 5205180006071443654
  30 | 5321963486263109186
     |                   0
(31 rows)

select key, stddev_samp(bigsrl_x)::bigint    from strom_overflow_test  group by key order by key;
 key |     stddev_samp     
-----+---------------------
   1 | 2608278721183613490
   2 | 2671917775328766763
   3 | 2667386919211443298
   4 | 2613289621770389332
   5 | 2660609917017003553
   6 | 2612142365440707752
   7 | 2695405583288260547
   8 | 2695431521329053805
   9 | 2657660608701103891
  10 | 2714542775263594419
  11 | 2643922144989386829
  12 | 2635062101573317824
  13 | 2602798467340843940
  14 | 2686796537962288567
  15 | 2639940094938097094
  16 | 2673263840743710611
  17 | 2671209799755162265
  18 | 2628121224411239138
  19 | 2640885518806306076
  20 | 2660489123859394241
  21 | 5279636141550424094
  22 | 5289777460091846726
  23 | 5275751118060349421
  24 | 5270442777150705130
  25 | 5388294458279664273
  26 | 5391310279324277415
  27 | 5417798802661513794
  28 | 5240610166507128356
  29 | 5207784549645024979
  30 | 5324626465407118214
     |                   0
(31 rows)

select key, variance(bigsrl_x)::bigint       from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, var_pop(bigsrl_x)::bigint        from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key, var_samp(bigsrl_x)::bigint       from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key,corr(bigsrl_x,bigsrl_x)::bigint from strom_overflow_test  group by key order by key;
 key | corr 
-----+------
   1 |    1
   2 |    1
   3 |    1
   4 |    1
   5 |    1
   6 |    1
   7 |    1
   8 |    1
   9 |    1
  10 |    1
  11 |    1
  12 |    1
  13 |    1
  14 |    1
  15 |    1
  16 |    1
  17 |    1
  18 |    1
  19 |    1
  20 |    1
  21 |    1
  22 |    1
  23 |    1
  24 |    1
  25 |    1
  26 |    1
  27 |    1
  28 |    1
  29 |    1
  30 |    1
     |     
(31 rows)

select key,covar_pop(bigsrl_x,bigsrl_x)::bigint from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
select key,covar_samp(bigsrl_x,bigsrl_x)::bigint from strom_overflow_test  group by key order by key;
ERROR:  bigint out of range
