---
--- Micro test cases for date & time operators / functions
---
SET pg_strom.regression_test_mode = on;
SET client_min_messages = error;
DROP SCHEMA IF EXISTS regtest_dtype_time_temp CASCADE;
CREATE SCHEMA regtest_dtype_time_temp;
RESET client_min_messages;
SET search_path = regtest_dtype_time_temp,public;
CREATE TABLE rt_datetime (
  id      int,
  d1      date,
  d2      date,
  t1      time,
  t2      time,
  t3      time,
  t4      time,
  tz1     timetz,
  tz2     timetz,
  tz3     timetz,
  tz4     timetz,
  ts1     timestamp,
  ts2     timestamp,
  ts3     timestamp,
  ts4     timestamp,
  tsz1    timestamptz,
  tsz2    timestamptz,
  tsz3    timestamptz,
  tsz4    timestamptz,
  iv1     interval,
  iv2     interval,
  ival    int
);
SELECT pgstrom.random_setseed(20190613);
 random_setseed 
----------------
 
(1 row)

INSERT INTO rt_datetime (
  SELECT x, pgstrom.random_date(1.0),
            pgstrom.random_date(1.0),
            pgstrom.random_time(1.0),
            pgstrom.random_time(1.0),
            pgstrom.random_time(1.0),
            pgstrom.random_time(1.0),
            pgstrom.random_timetz(1.0),
            pgstrom.random_timetz(1.0),
            pgstrom.random_timetz(1.0),
            pgstrom.random_timetz(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(1.0),
            pgstrom.random_timestamp(0.5) - pgstrom.random_timestamp(0.5),
            pgstrom.random_timestamp(0.5) - pgstrom.random_timestamp(0.5),
            pgstrom.random_int(1,-32000,32000)
    FROM generate_series(1,3000) x);
VACUUM ANALYZE;
-- force to use GpuScan, instead of SeqScan
SET enable_seqscan = off;
-- type cast operators
SET timezone = 'Japan';
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test01g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                                      QUERY PLAN                                                                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1)::timestamp without time zone), ((d2)::timestamp with time zone), (t1)::time with time zone, ((ts1)::date), ((ts2)::time without time zone), ((ts1)::timestamp with time zone), ((tsz1)::date), ((tsz1)::time without time zone), (tsz2)::time with time zone
   GPU Projection: rt_datetime.id, (rt_datetime.d1)::timestamp without time zone, (rt_datetime.d2)::timestamp with time zone, rt_datetime.t1, (rt_datetime.ts1)::date, (rt_datetime.ts2)::time without time zone, (rt_datetime.ts1)::timestamp with time zone, (rt_datetime.tsz1)::date, (rt_datetime.tsz1)::time without time zone, rt_datetime.tsz2
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test01g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test01p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test01g EXCEPT SELECT * FROM test01p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 
----+----+----+----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test01p EXCEPT SELECT * FROM test01g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 
----+----+----+----+----+----+----+----+----+----
(0 rows)

-- type cast operators (different timezone)
SET timezone = 'CET';
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test02g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                                      QUERY PLAN                                                                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1)::timestamp without time zone), ((d2)::timestamp with time zone), (t1)::time with time zone, ((ts1)::date), ((ts2)::time without time zone), ((ts1)::timestamp with time zone), ((tsz1)::date), ((tsz1)::time without time zone), (tsz2)::time with time zone
   GPU Projection: rt_datetime.id, (rt_datetime.d1)::timestamp without time zone, (rt_datetime.d2)::timestamp with time zone, rt_datetime.t1, (rt_datetime.ts1)::date, (rt_datetime.ts2)::time without time zone, (rt_datetime.ts1)::timestamp with time zone, (rt_datetime.tsz1)::date, (rt_datetime.tsz1)::time without time zone, rt_datetime.tsz2
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test02g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1::timestamp v1, d2::timestamptz v2, t1::timetz v3,
           ts1::date v4, ts2::time v5, ts1::timestamptz v6,
           tsz1::date v7, tsz1::time v8, tsz2::timetz v9
  INTO test02p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test02g EXCEPT SELECT * FROM test02p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 
----+----+----+----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test02p EXCEPT SELECT * FROM test02g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 
----+----+----+----+----+----+----+----+----+----
(0 rows)

-- 'date' operators
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1 + ival v1, d2 - ival v2, d1 - d2 v3,
           d1 + t1 v4, d2 + tz1 v5, timestamptz(d1, tz2) v6
  INTO test10g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1 + ival)), ((d2 - ival)), ((d1 - d2)), ((d1 + t1)), (d2 + tz1), timestamptz(d1, tz2)
   GPU Projection: rt_datetime.id, (rt_datetime.d1 + rt_datetime.ival), (rt_datetime.d2 - rt_datetime.ival), (rt_datetime.d1 - rt_datetime.d2), (rt_datetime.d1 + rt_datetime.t1), rt_datetime.d2, rt_datetime.tz1, rt_datetime.d1, rt_datetime.tz2
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1 + ival v1, d2 - ival v2, d1 - d2 v3,
           d1 + t1 v4, d2 + tz1 v5, timestamptz(d1, tz2) v6
  INTO test10g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1 + ival v1, d2 - ival v2, d1 - d2 v3,
           d1 + t1 v4, d2 + tz1 v5, timestamptz(d1, tz2) v6
  INTO test10p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test10g EXCEPT SELECT * FROM test10p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test10p EXCEPT SELECT * FROM test10g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'time' and 'timetz' operators
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, t1 + d2 v1, t2 - t1 v2,
           tz1 + iv1 v3, tz2 - iv2 v4
  INTO test11g
  FROM rt_datetime
 WHERE id > 0;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d2 + t1)), ((t2 - t1)), ((tz1 + iv1)), ((tz2 - iv2))
   GPU Projection: rt_datetime.id, (rt_datetime.d2 + rt_datetime.t1), (rt_datetime.t2 - rt_datetime.t1), (rt_datetime.tz1 + rt_datetime.iv1), (rt_datetime.tz2 - rt_datetime.iv2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, t1 + d2 v1, t2 - t1 v2,
           tz1 + iv1 v3, tz2 - iv2 v4
  INTO test11g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, t1 + d2 v1, t2 - t1 v2,
           tz1 + iv1 v3, tz2 - iv2 v4
  INTO test11p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test11g EXCEPT SELECT * FROM test11p) ORDER BY id;
 id | v1 | v2 | v3 | v4 
----+----+----+----+----
(0 rows)

(SELECT * FROM test11p EXCEPT SELECT * FROM test11g) ORDER BY id;
 id | v1 | v2 | v3 | v4 
----+----+----+----+----
(0 rows)

-- 'timestamp' and 'timestamptz' operators
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, ts1 - ts2 v1, tsz1 + iv1 v2, tsz2 - iv2 v3
  INTO test12g
  FROM rt_datetime
 WHERE id > 0;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((ts1 - ts2)), ((tsz1 + iv1)), ((tsz2 - iv2))
   GPU Projection: rt_datetime.id, (rt_datetime.ts1 - rt_datetime.ts2), (rt_datetime.tsz1 + rt_datetime.iv1), (rt_datetime.tsz2 - rt_datetime.iv2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, ts1 - ts2 v1, tsz1 + iv1 v2, tsz2 - iv2 v3
  INTO test12g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, ts1 - ts2 v1, tsz1 + iv1 v2, tsz2 - iv2 v3
  INTO test12p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test12g EXCEPT SELECT * FROM test12p) ORDER BY id;
 id | v1 | v2 | v3 
----+----+----+----
(0 rows)

(SELECT * FROM test12p EXCEPT SELECT * FROM test12g) ORDER BY id;
 id | v1 | v2 | v3 
----+----+----+----
(0 rows)

-- 'interval' operators
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, -iv1 v1, iv1 + iv2 v2, iv2 - iv1 v3
  INTO test13g
  FROM rt_datetime
 WHERE id > 0;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((- iv1)), ((iv1 + iv2)), ((iv2 - iv1))
   GPU Projection: rt_datetime.id, (- rt_datetime.iv1), (rt_datetime.iv1 + rt_datetime.iv2), (rt_datetime.iv2 - rt_datetime.iv1)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, -iv1 v1, iv1 + iv2 v2, iv2 - iv1 v3
  INTO test13g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, -iv1 v1, iv1 + iv2 v2, iv2 - iv1 v3
  INTO test13p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test13g EXCEPT SELECT * FROM test13p) ORDER BY id;
 id | v1 | v2 | v3 
----+----+----+----
(0 rows)

(SELECT * FROM test13p EXCEPT SELECT * FROM test13g) ORDER BY id;
 id | v1 | v2 | v3 
----+----+----+----
(0 rows)

-- 'date' <COMP> 'date'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1 =  d2 v1, d1 <> d2 v2, d1 <  d2 v3,
           d1 <= d2 v4, d1 >  d2 v5, d1 >= d2 v6
  INTO test20g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1 = d2)), ((d1 <> d2)), ((d1 < d2)), ((d1 <= d2)), ((d1 > d2)), ((d1 >= d2))
   GPU Projection: rt_datetime.id, (rt_datetime.d1 = rt_datetime.d2), (rt_datetime.d1 <> rt_datetime.d2), (rt_datetime.d1 < rt_datetime.d2), (rt_datetime.d1 <= rt_datetime.d2), (rt_datetime.d1 > rt_datetime.d2), (rt_datetime.d1 >= rt_datetime.d2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1 =  d2 v1, d1 <> d2 v2, d1 <  d2 v3,
           d1 <= d2 v4, d1 >  d2 v5, d1 >= d2 v6
  INTO test20g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1 =  d2 v1, d1 <> d2 v2, d1 <  d2 v3,
           d1 <= d2 v4, d1 >  d2 v5, d1 >= d2 v6
  INTO test20p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test20g EXCEPT SELECT * FROM test20p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test20p EXCEPT SELECT * FROM test20g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'date' <COMP> 'timestamp'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1 =  ts2 v1, d1 <> ts2 v2, d1 <  ts2 v3,
           d1 <= ts2 v4, d1 >  ts2 v5, d1 >= ts2 v6
  INTO test21g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1 = ts2)), ((d1 <> ts2)), ((d1 < ts2)), ((d1 <= ts2)), ((d1 > ts2)), ((d1 >= ts2))
   GPU Projection: rt_datetime.id, (rt_datetime.d1 = rt_datetime.ts2), (rt_datetime.d1 <> rt_datetime.ts2), (rt_datetime.d1 < rt_datetime.ts2), (rt_datetime.d1 <= rt_datetime.ts2), (rt_datetime.d1 > rt_datetime.ts2), (rt_datetime.d1 >= rt_datetime.ts2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1 =  ts2 v1, d1 <> ts2 v2, d1 <  ts2 v3,
           d1 <= ts2 v4, d1 >  ts2 v5, d1 >= ts2 v6
  INTO test21g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1 =  ts2 v1, d1 <> ts2 v2, d1 <  ts2 v3,
           d1 <= ts2 v4, d1 >  ts2 v5, d1 >= ts2 v6
  INTO test21p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test21g EXCEPT SELECT * FROM test21p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test21p EXCEPT SELECT * FROM test21g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamp' <COMP> 'date'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test22g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((ts1 = d2)), ((ts1 <> d2)), ((ts1 < d2)), ((ts1 <= d2)), ((ts1 > d2)), ((ts1 >= d2))
   GPU Projection: rt_datetime.id, (rt_datetime.ts1 = rt_datetime.d2), (rt_datetime.ts1 <> rt_datetime.d2), (rt_datetime.ts1 < rt_datetime.d2), (rt_datetime.ts1 <= rt_datetime.d2), (rt_datetime.ts1 > rt_datetime.d2), (rt_datetime.ts1 >= rt_datetime.d2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test22g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test22p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test22g EXCEPT SELECT * FROM test22p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test22p EXCEPT SELECT * FROM test22g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'date' <COMP> 'timestamptz'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test23g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1 = tsz2)), ((d1 <> tsz2)), ((d1 < tsz2)), ((d1 <= tsz2)), ((d1 > tsz2)), ((d1 >= tsz2))
   GPU Projection: rt_datetime.id, (rt_datetime.d1 = rt_datetime.tsz2), (rt_datetime.d1 <> rt_datetime.tsz2), (rt_datetime.d1 < rt_datetime.tsz2), (rt_datetime.d1 <= rt_datetime.tsz2), (rt_datetime.d1 > rt_datetime.tsz2), (rt_datetime.d1 >= rt_datetime.tsz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test23g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test23p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test23g EXCEPT SELECT * FROM test23p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test23p EXCEPT SELECT * FROM test23g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamptz' <COMP> 'date'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test24g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((tsz1 = d2)), ((tsz1 <> d2)), ((tsz1 < d2)), ((tsz1 <= d2)), ((tsz1 > d2)), ((tsz1 >= d2))
   GPU Projection: rt_datetime.id, (rt_datetime.tsz1 = rt_datetime.d2), (rt_datetime.tsz1 <> rt_datetime.d2), (rt_datetime.tsz1 < rt_datetime.d2), (rt_datetime.tsz1 <= rt_datetime.d2), (rt_datetime.tsz1 > rt_datetime.d2), (rt_datetime.tsz1 >= rt_datetime.d2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test24g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test24p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test24g EXCEPT SELECT * FROM test24p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test24p EXCEPT SELECT * FROM test24g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'time' <COMP> 'time'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, t1 =  t2 v1, t1 <> t2 v2, t1 <  t2 v3,
           t1 <= t2 v4, t1 >  t2 v5, t1 >= t2 v6
  INTO test25g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((t1 = t2)), ((t1 <> t2)), ((t1 < t2)), ((t1 <= t2)), ((t1 > t2)), ((t1 >= t2))
   GPU Projection: rt_datetime.id, (rt_datetime.t1 = rt_datetime.t2), (rt_datetime.t1 <> rt_datetime.t2), (rt_datetime.t1 < rt_datetime.t2), (rt_datetime.t1 <= rt_datetime.t2), (rt_datetime.t1 > rt_datetime.t2), (rt_datetime.t1 >= rt_datetime.t2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, t1 =  t2 v1, t1 <> t2 v2, t1 <  t2 v3,
           t1 <= t2 v4, t1 >  t2 v5, t1 >= t2 v6
  INTO test25g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, t1 =  t2 v1, t1 <> t2 v2, t1 <  t2 v3,
           t1 <= t2 v4, t1 >  t2 v5, t1 >= t2 v6
  INTO test25p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test25g EXCEPT SELECT * FROM test25p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test25p EXCEPT SELECT * FROM test25g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timetz' <COMP> 'timetz'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, tz1 =  tz2 v1, tz1 <> tz2 v2, tz1 <  tz2 v3,
           tz1 <= tz2 v4, tz1 >  tz2 v5, tz1 >= tz2 v6
  INTO test26g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((tz1 = tz2)), ((tz1 <> tz2)), ((tz1 < tz2)), ((tz1 <= tz2)), ((tz1 > tz2)), ((tz1 >= tz2))
   GPU Projection: rt_datetime.id, (rt_datetime.tz1 = rt_datetime.tz2), (rt_datetime.tz1 <> rt_datetime.tz2), (rt_datetime.tz1 < rt_datetime.tz2), (rt_datetime.tz1 <= rt_datetime.tz2), (rt_datetime.tz1 > rt_datetime.tz2), (rt_datetime.tz1 >= rt_datetime.tz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, tz1 =  tz2 v1, tz1 <> tz2 v2, tz1 <  tz2 v3,
           tz1 <= tz2 v4, tz1 >  tz2 v5, tz1 >= tz2 v6
  INTO test26g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, tz1 =  tz2 v1, tz1 <> tz2 v2, tz1 <  tz2 v3,
           tz1 <= tz2 v4, tz1 >  tz2 v5, tz1 >= tz2 v6
  INTO test26p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test26g EXCEPT SELECT * FROM test26p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test26p EXCEPT SELECT * FROM test26g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamp' <COMP> 'timestamp'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, ts1 =  ts2 v1, ts1 <> ts2 v2, ts1 <  ts2 v3,
           ts1 <= ts2 v4, ts1 >  ts2 v5, ts1 >= ts2 v6
  INTO test27g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((ts1 = ts2)), ((ts1 <> ts2)), ((ts1 < ts2)), ((ts1 <= ts2)), ((ts1 > ts2)), ((ts1 >= ts2))
   GPU Projection: rt_datetime.id, (rt_datetime.ts1 = rt_datetime.ts2), (rt_datetime.ts1 <> rt_datetime.ts2), (rt_datetime.ts1 < rt_datetime.ts2), (rt_datetime.ts1 <= rt_datetime.ts2), (rt_datetime.ts1 > rt_datetime.ts2), (rt_datetime.ts1 >= rt_datetime.ts2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, ts1 =  ts2 v1, ts1 <> ts2 v2, ts1 <  ts2 v3,
           ts1 <= ts2 v4, ts1 >  ts2 v5, ts1 >= ts2 v6
  INTO test27g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, ts1 =  ts2 v1, ts1 <> ts2 v2, ts1 <  ts2 v3,
           ts1 <= ts2 v4, ts1 >  ts2 v5, ts1 >= ts2 v6
  INTO test27p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test27g EXCEPT SELECT * FROM test27p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test27p EXCEPT SELECT * FROM test27g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamp' <COMP> 'date'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test28g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((ts1 = d2)), ((ts1 <> d2)), ((ts1 < d2)), ((ts1 <= d2)), ((ts1 > d2)), ((ts1 >= d2))
   GPU Projection: rt_datetime.id, (rt_datetime.ts1 = rt_datetime.d2), (rt_datetime.ts1 <> rt_datetime.d2), (rt_datetime.ts1 < rt_datetime.d2), (rt_datetime.ts1 <= rt_datetime.d2), (rt_datetime.ts1 > rt_datetime.d2), (rt_datetime.ts1 >= rt_datetime.d2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test28g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, ts1 =  d2 v1, ts1 <> d2 v2, ts1 <  d2 v3,
           ts1 <= d2 v4, ts1 >  d2 v5, ts1 >= d2 v6
  INTO test28p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test28g EXCEPT SELECT * FROM test28p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test28p EXCEPT SELECT * FROM test28g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamptz' <COMP> 'timestamptz'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test29g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                  QUERY PLAN                                                                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((tsz1 = tsz2)), ((tsz1 <> tsz2)), ((tsz1 < tsz2)), ((tsz1 <= tsz2)), ((tsz1 > tsz2)), ((tsz1 >= tsz2))
   GPU Projection: rt_datetime.id, (rt_datetime.tsz1 = rt_datetime.tsz2), (rt_datetime.tsz1 <> rt_datetime.tsz2), (rt_datetime.tsz1 < rt_datetime.tsz2), (rt_datetime.tsz1 <= rt_datetime.tsz2), (rt_datetime.tsz1 > rt_datetime.tsz2), (rt_datetime.tsz1 >= rt_datetime.tsz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test29g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test29p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test29g EXCEPT SELECT * FROM test29p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test29p EXCEPT SELECT * FROM test29g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'date' <COMP> 'timestamptz'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test30g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((d1 = tsz2)), ((d1 <> tsz2)), ((d1 < tsz2)), ((d1 <= tsz2)), ((d1 > tsz2)), ((d1 >= tsz2))
   GPU Projection: rt_datetime.id, (rt_datetime.d1 = rt_datetime.tsz2), (rt_datetime.d1 <> rt_datetime.tsz2), (rt_datetime.d1 < rt_datetime.tsz2), (rt_datetime.d1 <= rt_datetime.tsz2), (rt_datetime.d1 > rt_datetime.tsz2), (rt_datetime.d1 >= rt_datetime.tsz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test30g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, d1 =  tsz2 v1, d1 <> tsz2 v2, d1 <  tsz2 v3,
           d1 <= tsz2 v4, d1 >  tsz2 v5, d1 >= tsz2 v6
  INTO test30p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test30g EXCEPT SELECT * FROM test30p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test30p EXCEPT SELECT * FROM test30g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamptz' <COMP> 'date'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test31g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((tsz1 = d2)), ((tsz1 <> d2)), ((tsz1 < d2)), ((tsz1 <= d2)), ((tsz1 > d2)), ((tsz1 >= d2))
   GPU Projection: rt_datetime.id, (rt_datetime.tsz1 = rt_datetime.d2), (rt_datetime.tsz1 <> rt_datetime.d2), (rt_datetime.tsz1 < rt_datetime.d2), (rt_datetime.tsz1 <= rt_datetime.d2), (rt_datetime.tsz1 > rt_datetime.d2), (rt_datetime.tsz1 >= rt_datetime.d2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test31g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, tsz1 =  d2 v1, tsz1 <> d2 v2, tsz1 <  d2 v3,
           tsz1 <= d2 v4, tsz1 >  d2 v5, tsz1 >= d2 v6
  INTO test31p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test31g EXCEPT SELECT * FROM test31p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test31p EXCEPT SELECT * FROM test31g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamp' <COMP> 'timestamptz'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, ts1 =  tsz2 v1, ts1 <> tsz2 v2, ts1 <  tsz2 v3,
           ts1 <= tsz2 v4, ts1 >  tsz2 v5, ts1 >= tsz2 v6
  INTO test32g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((ts1 = tsz2)), ((ts1 <> tsz2)), ((ts1 < tsz2)), ((ts1 <= tsz2)), ((ts1 > tsz2)), ((ts1 >= tsz2))
   GPU Projection: rt_datetime.id, (rt_datetime.ts1 = rt_datetime.tsz2), (rt_datetime.ts1 <> rt_datetime.tsz2), (rt_datetime.ts1 < rt_datetime.tsz2), (rt_datetime.ts1 <= rt_datetime.tsz2), (rt_datetime.ts1 > rt_datetime.tsz2), (rt_datetime.ts1 >= rt_datetime.tsz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, ts1 =  tsz2 v1, ts1 <> tsz2 v2, ts1 <  tsz2 v3,
           ts1 <= tsz2 v4, ts1 >  tsz2 v5, ts1 >= tsz2 v6
  INTO test32g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, ts1 =  tsz2 v1, ts1 <> tsz2 v2, ts1 <  tsz2 v3,
           ts1 <= tsz2 v4, ts1 >  tsz2 v5, ts1 >= tsz2 v6
  INTO test32p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test32g EXCEPT SELECT * FROM test32p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test32p EXCEPT SELECT * FROM test32g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'timestamptz' <COMP> 'timestamp'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test33g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                  QUERY PLAN                                                                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((tsz1 = tsz2)), ((tsz1 <> tsz2)), ((tsz1 < tsz2)), ((tsz1 <= tsz2)), ((tsz1 > tsz2)), ((tsz1 >= tsz2))
   GPU Projection: rt_datetime.id, (rt_datetime.tsz1 = rt_datetime.tsz2), (rt_datetime.tsz1 <> rt_datetime.tsz2), (rt_datetime.tsz1 < rt_datetime.tsz2), (rt_datetime.tsz1 <= rt_datetime.tsz2), (rt_datetime.tsz1 > rt_datetime.tsz2), (rt_datetime.tsz1 >= rt_datetime.tsz2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test33g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, tsz1 =  tsz2 v1, tsz1 <> tsz2 v2, tsz1 <  tsz2 v3,
           tsz1 <= tsz2 v4, tsz1 >  tsz2 v5, tsz1 >= tsz2 v6
  INTO test33p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test33g EXCEPT SELECT * FROM test33p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test33p EXCEPT SELECT * FROM test33g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- 'interval' <COMP> 'interval'
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, iv1 =  iv2 v1, iv1 <> iv2 v2, iv1 <  iv2 v3,
           iv1 <= iv2 v4, iv1 >  iv2 v5, iv1 >= iv2 v6
  INTO test34g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((iv1 = iv2)), ((iv1 <> iv2)), ((iv1 < iv2)), ((iv1 <= iv2)), ((iv1 > iv2)), ((iv1 >= iv2))
   GPU Projection: rt_datetime.id, (rt_datetime.iv1 = rt_datetime.iv2), (rt_datetime.iv1 <> rt_datetime.iv2), (rt_datetime.iv1 < rt_datetime.iv2), (rt_datetime.iv1 <= rt_datetime.iv2), (rt_datetime.iv1 > rt_datetime.iv2), (rt_datetime.iv1 >= rt_datetime.iv2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, iv1 =  iv2 v1, iv1 <> iv2 v2, iv1 <  iv2 v3,
           iv1 <= iv2 v4, iv1 >  iv2 v5, iv1 >= iv2 v6
  INTO test34g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, iv1 =  iv2 v1, iv1 <> iv2 v2, iv1 <  iv2 v3,
           iv1 <= iv2 v4, iv1 >  iv2 v5, iv1 >= iv2 v6
  INTO test34p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test34g EXCEPT SELECT * FROM test34p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test34p EXCEPT SELECT * FROM test34g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 
----+----+----+----+----+----+----
(0 rows)

-- test for overlaps functions
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, (t1,t2)     OVERLAPS (t3,t4)     v1,
           (t1,t3)     OVERLAPS (t2,t4)     v2,
           (tz1,tz2)   OVERLAPS (tz3,tz4)   v3,
           (tz1,tz3)   OVERLAPS (tz2,tz4)   v4,
           (ts1,ts2)   OVERLAPS (ts3,ts4)   v5,
           (ts1,ts3)   OVERLAPS (ts2,ts4)   v6,
           (tsz1,tsz2) OVERLAPS (tsz3,tsz4) v7,
           (tsz1,tsz3) OVERLAPS (tsz2,tsz4) v8
  INTO test40g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                    QUERY PLAN                                                                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, ((t1, t2) OVERLAPS (t3, t4)), ((t1, t3) OVERLAPS (t2, t4)), ((tz1, tz2) OVERLAPS (tz3, tz4)), ((tz1, tz3) OVERLAPS (tz2, tz4)), ((ts1, ts2) OVERLAPS (ts3, ts4)), ((ts1, ts3) OVERLAPS (ts2, ts4)), ((tsz1, tsz2) OVERLAPS (tsz3, tsz4)), ((tsz1, tsz3) OVERLAPS (tsz2, tsz4))
   GPU Projection: rt_datetime.id, rt_datetime.t1, rt_datetime.t2, rt_datetime.t3, rt_datetime.t4, rt_datetime.tz1, rt_datetime.tz2, rt_datetime.tz3, rt_datetime.tz4, rt_datetime.ts1, rt_datetime.ts2, rt_datetime.ts3, rt_datetime.ts4, rt_datetime.tsz1, rt_datetime.tsz2, rt_datetime.tsz3, rt_datetime.tsz4
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, (t1,t2)     OVERLAPS (t3,t4)     v1,
           (t1,t3)     OVERLAPS (t2,t4)     v2,
           (tz1,tz2)   OVERLAPS (tz3,tz4)   v3,
           (tz1,tz3)   OVERLAPS (tz2,tz4)   v4,
           (ts1,ts2)   OVERLAPS (ts3,ts4)   v5,
           (ts1,ts3)   OVERLAPS (ts2,ts4)   v6,
           (tsz1,tsz2) OVERLAPS (tsz3,tsz4) v7,
           (tsz1,tsz3) OVERLAPS (tsz2,tsz4) v8
  INTO test40g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, (t1,t2)     OVERLAPS (t3,t4)     v1,
           (t1,t3)     OVERLAPS (t2,t4)     v2,
           (tz1,tz2)   OVERLAPS (tz3,tz4)   v3,
           (tz1,tz3)   OVERLAPS (tz2,tz4)   v4,
           (ts1,ts2)   OVERLAPS (ts3,ts4)   v5,
           (ts1,ts3)   OVERLAPS (ts2,ts4)   v6,
           (tsz1,tsz2) OVERLAPS (tsz3,tsz4) v7,
           (tsz1,tsz3) OVERLAPS (tsz2,tsz4) v8
  INTO test40p
  FROM rt_datetime
 WHERE id > 0;
(SELECT * FROM test40g EXCEPT SELECT * FROM test40p) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 
----+----+----+----+----+----+----+----+----
(0 rows)

(SELECT * FROM test40p EXCEPT SELECT * FROM test40g) ORDER BY id;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 
----+----+----+----+----+----+----+----+----
(0 rows)

-- extract() on 'time' type
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, EXTRACT (microseconds FROM t1) v1,
           EXTRACT (milliseconds FROM t2) v2,
           EXTRACT (second FROM t3) v3,
           EXTRACT (minute FROM t4) v4,
           EXTRACT (hour FROM t1) v5
  INTO test41g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, (EXTRACT(microseconds FROM t1)), (EXTRACT(milliseconds FROM t2)), (EXTRACT(second FROM t3)), (EXTRACT(minute FROM t4)), (EXTRACT(hour FROM t1))
   GPU Projection: rt_datetime.id, EXTRACT(microseconds FROM rt_datetime.t1), EXTRACT(milliseconds FROM rt_datetime.t2), EXTRACT(second FROM rt_datetime.t3), EXTRACT(minute FROM rt_datetime.t4), EXTRACT(hour FROM rt_datetime.t1)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, EXTRACT (microseconds FROM t1) v1,
           EXTRACT (milliseconds FROM t2) v2,
           EXTRACT (second FROM t3) v3,
           EXTRACT (minute FROM t4) v4,
           EXTRACT (hour FROM t1) v5
  INTO test41g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, EXTRACT (microseconds FROM t1) v1,
           EXTRACT (milliseconds FROM t2) v2,
           EXTRACT (second FROM t3) v3,
           EXTRACT (minute FROM t4) v4,
           EXTRACT (hour FROM t1) v5
  INTO test41p
  FROM rt_datetime
 WHERE id > 0;
SELECT * FROM test41g AS a, test41p AS b WHERE a.id=b.id AND
(
  ABS(a.v1 - b.v1) > 0.1
  OR ABS(a.v2 - b.v2) > 0.1
  OR ABS(a.v3 - b.v3) > 0.1
  OR ABS(a.v4 - b.v4) > 0.1
  OR ABS(a.v5 - b.v5) > 0.1
) LIMIT 5;
 id | v1 | v2 | v3 | v4 | v5 | id | v1 | v2 | v3 | v4 | v5 
----+----+----+----+----+----+----+----+----+----+----+----
(0 rows)

-- extract() on 'timetz' type
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, EXTRACT (microseconds FROM tz1) v1,
           EXTRACT (milliseconds FROM tz2) v2,
           EXTRACT (second FROM tz3) v3,
           EXTRACT (minute FROM tz4) v4,
           EXTRACT (hour FROM tz1) v5
  INTO test42g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, (EXTRACT(microseconds FROM tz1)), (EXTRACT(milliseconds FROM tz2)), (EXTRACT(second FROM tz3)), (EXTRACT(minute FROM tz4)), (EXTRACT(hour FROM tz1))
   GPU Projection: rt_datetime.id, EXTRACT(microseconds FROM rt_datetime.tz1), EXTRACT(milliseconds FROM rt_datetime.tz2), EXTRACT(second FROM rt_datetime.tz3), EXTRACT(minute FROM rt_datetime.tz4), EXTRACT(hour FROM rt_datetime.tz1)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, EXTRACT (microseconds FROM tz1) v1,
           EXTRACT (milliseconds FROM tz2) v2,
           EXTRACT (second FROM tz3) v3,
           EXTRACT (minute FROM tz4) v4,
           EXTRACT (hour FROM tz1) v5
  INTO test42g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, EXTRACT (microseconds FROM tz1) v1,
           EXTRACT (milliseconds FROM tz2) v2,
           EXTRACT (second FROM tz3) v3,
           EXTRACT (minute FROM tz4) v4,
           EXTRACT (hour FROM tz1) v5
  INTO test42p
  FROM rt_datetime
 WHERE id > 0;
SELECT * FROM test42g AS a, test42p AS b WHERE a.id=b.id AND
(
  ABS(a.v1 - b.v1) > 0.1
  OR ABS(a.v2 - b.v2) > 0.1
  OR ABS(a.v3 - b.v3) > 0.1
  OR ABS(a.v4 - b.v4) > 0.1
  OR ABS(a.v5 - b.v5) > 0.1
) LIMIT 5;
 id | v1 | v2 | v3 | v4 | v5 | id | v1 | v2 | v3 | v4 | v5 
----+----+----+----+----+----+----+----+----+----+----+----
(0 rows)

-- extract() on 'timestamp' type
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, EXTRACT (century         FROM ts1) v1,
           EXTRACT (day             FROM ts2) v2,
           EXTRACT (decade          FROM ts1) v3,
           EXTRACT (dow             FROM ts2) v4,
           EXTRACT (doy             FROM ts1) v5,
           EXTRACT (epoch           FROM ts2) v6,
           EXTRACT (hour            FROM ts1) v7,
           EXTRACT (isodow          FROM ts2) v8,
           EXTRACT (isoyear         FROM ts1) v9,
           EXTRACT (microseconds    FROM ts2) v10,
           EXTRACT (millennium      FROM ts1) v11,
           EXTRACT (milliseconds    FROM ts2) v12,
           EXTRACT (minute          FROM ts1) v13,
           EXTRACT (month           FROM ts2) v14,
           EXTRACT (quarter         FROM ts1) v15,
           EXTRACT (second          FROM ts2) v16,
           EXTRACT (week            FROM ts2) v17,
           EXTRACT (year            FROM ts1) v18
  INTO test43g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, (EXTRACT(century FROM ts1)), (EXTRACT(day FROM ts2)), (EXTRACT(decade FROM ts1)), (EXTRACT(dow FROM ts2)), (EXTRACT(doy FROM ts1)), (EXTRACT(epoch FROM ts2)), (EXTRACT(hour FROM ts1)), (EXTRACT(isodow FROM ts2)), (EXTRACT(isoyear FROM ts1)), (EXTRACT(microseconds FROM ts2)), (EXTRACT(millennium FROM ts1)), (EXTRACT(milliseconds FROM ts2)), (EXTRACT(minute FROM ts1)), (EXTRACT(month FROM ts2)), (EXTRACT(quarter FROM ts1)), (EXTRACT(second FROM ts2)), (EXTRACT(week FROM ts2)), (EXTRACT(year FROM ts1))
   GPU Projection: rt_datetime.id, EXTRACT(century FROM rt_datetime.ts1), EXTRACT(day FROM rt_datetime.ts2), EXTRACT(decade FROM rt_datetime.ts1), EXTRACT(dow FROM rt_datetime.ts2), EXTRACT(doy FROM rt_datetime.ts1), EXTRACT(epoch FROM rt_datetime.ts2), EXTRACT(hour FROM rt_datetime.ts1), EXTRACT(isodow FROM rt_datetime.ts2), EXTRACT(isoyear FROM rt_datetime.ts1), EXTRACT(microseconds FROM rt_datetime.ts2), EXTRACT(millennium FROM rt_datetime.ts1), EXTRACT(milliseconds FROM rt_datetime.ts2), EXTRACT(minute FROM rt_datetime.ts1), EXTRACT(month FROM rt_datetime.ts2), EXTRACT(quarter FROM rt_datetime.ts1), EXTRACT(second FROM rt_datetime.ts2), EXTRACT(week FROM rt_datetime.ts2), EXTRACT(year FROM rt_datetime.ts1)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, EXTRACT (century         FROM ts1) v1,
           EXTRACT (day             FROM ts2) v2,
           EXTRACT (decade          FROM ts1) v3,
           EXTRACT (dow             FROM ts2) v4,
           EXTRACT (doy             FROM ts1) v5,
           EXTRACT (epoch           FROM ts2) v6,
           EXTRACT (hour            FROM ts1) v7,
           EXTRACT (isodow          FROM ts2) v8,
           EXTRACT (isoyear         FROM ts1) v9,
           EXTRACT (microseconds    FROM ts2) v10,
           EXTRACT (millennium      FROM ts1) v11,
           EXTRACT (milliseconds    FROM ts2) v12,
           EXTRACT (minute          FROM ts1) v13,
           EXTRACT (month           FROM ts2) v14,
           EXTRACT (quarter         FROM ts1) v15,
           EXTRACT (second          FROM ts2) v16,
           EXTRACT (week            FROM ts2) v17,
           EXTRACT (year            FROM ts1) v18
  INTO test43g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, EXTRACT (century         FROM ts1) v1,
           EXTRACT (day             FROM ts2) v2,
           EXTRACT (decade          FROM ts1) v3,
           EXTRACT (dow             FROM ts2) v4,
           EXTRACT (doy             FROM ts1) v5,
           EXTRACT (epoch           FROM ts2) v6,
           EXTRACT (hour            FROM ts1) v7,
           EXTRACT (isodow          FROM ts2) v8,
           EXTRACT (isoyear         FROM ts1) v9,
           EXTRACT (microseconds    FROM ts2) v10,
           EXTRACT (millennium      FROM ts1) v11,
           EXTRACT (milliseconds    FROM ts2) v12,
           EXTRACT (minute          FROM ts1) v13,
           EXTRACT (month           FROM ts2) v14,
           EXTRACT (quarter         FROM ts1) v15,
           EXTRACT (second          FROM ts2) v16,
           EXTRACT (week            FROM ts2) v17,
           EXTRACT (year            FROM ts1) v18
  INTO test43p
  FROM rt_datetime
 WHERE id > 0;
SELECT * FROM test43g AS a, test43p AS b WHERE a.id=b.id AND
(
  ABS(a.v1 - b.v1) > 0.1
  OR ABS(a.v2 - b.v2) > 0.1
  OR ABS(a.v3 - b.v3) > 0.1
  OR ABS(a.v4 - b.v4) > 0.1
  OR ABS(a.v5 - b.v5) > 0.1
  OR ABS(a.v6 - b.v6) > 0.1
  OR ABS(a.v7 - b.v7) > 0.1
  OR ABS(a.v8 - b.v8) > 0.1
  OR ABS(a.v9 - b.v9) > 0.1
  OR ABS(a.v10 - b.v10) > 0.1
  OR ABS(a.v11 - b.v11) > 0.1
  OR ABS(a.v12 - b.v12) > 0.1
  OR ABS(a.v13 - b.v13) > 0.1
  OR ABS(a.v14 - b.v14) > 0.1
  OR ABS(a.v15 - b.v15) > 0.1
  OR ABS(a.v16 - b.v16) > 0.1
  OR ABS(a.v17 - b.v17) > 0.1
  OR ABS(a.v18 - b.v18) > 0.1
) LIMIT 5;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 | v13 | v14 | v15 | v16 | v17 | v18 | id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 | v13 | v14 | v15 | v16 | v17 | v18 
----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----
(0 rows)

-- extract() on 'timestamptz' type
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, EXTRACT (century         FROM tsz1) v1,
           EXTRACT (day             FROM tsz2) v2,
           EXTRACT (decade          FROM tsz1) v3,
           EXTRACT (dow             FROM tsz2) v4,
           EXTRACT (doy             FROM tsz1) v5,
           EXTRACT (epoch           FROM tsz2) v6,
           EXTRACT (hour            FROM tsz1) v7,
           EXTRACT (isodow          FROM tsz2) v8,
           EXTRACT (isoyear         FROM tsz1) v9,
           EXTRACT (microseconds    FROM tsz2) v10,
           EXTRACT (millennium      FROM tsz1) v11,
           EXTRACT (milliseconds    FROM tsz2) v12,
           EXTRACT (minute          FROM tsz1) v13,
           EXTRACT (month           FROM tsz2) v14,
           EXTRACT (quarter         FROM tsz1) v15,
           EXTRACT (second          FROM tsz2) v16,
           EXTRACT (timezone        FROM tsz1) v17,
           EXTRACT (timezone_hour   FROM tsz2) v18,
           EXTRACT (timezone_minute FROM tsz1) v19,
           EXTRACT (week            FROM tsz2) v20,
           EXTRACT (year            FROM tsz1) v21
  INTO test44g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, (EXTRACT(century FROM tsz1)), (EXTRACT(day FROM tsz2)), (EXTRACT(decade FROM tsz1)), (EXTRACT(dow FROM tsz2)), (EXTRACT(doy FROM tsz1)), (EXTRACT(epoch FROM tsz2)), (EXTRACT(hour FROM tsz1)), (EXTRACT(isodow FROM tsz2)), (EXTRACT(isoyear FROM tsz1)), (EXTRACT(microseconds FROM tsz2)), (EXTRACT(millennium FROM tsz1)), (EXTRACT(milliseconds FROM tsz2)), (EXTRACT(minute FROM tsz1)), (EXTRACT(month FROM tsz2)), (EXTRACT(quarter FROM tsz1)), (EXTRACT(second FROM tsz2)), (EXTRACT(timezone FROM tsz1)), (EXTRACT(timezone_hour FROM tsz2)), (EXTRACT(timezone_minute FROM tsz1)), (EXTRACT(week FROM tsz2)), (EXTRACT(year FROM tsz1))
   GPU Projection: rt_datetime.id, EXTRACT(century FROM rt_datetime.tsz1), EXTRACT(day FROM rt_datetime.tsz2), EXTRACT(decade FROM rt_datetime.tsz1), EXTRACT(dow FROM rt_datetime.tsz2), EXTRACT(doy FROM rt_datetime.tsz1), EXTRACT(epoch FROM rt_datetime.tsz2), EXTRACT(hour FROM rt_datetime.tsz1), EXTRACT(isodow FROM rt_datetime.tsz2), EXTRACT(isoyear FROM rt_datetime.tsz1), EXTRACT(microseconds FROM rt_datetime.tsz2), EXTRACT(millennium FROM rt_datetime.tsz1), EXTRACT(milliseconds FROM rt_datetime.tsz2), EXTRACT(minute FROM rt_datetime.tsz1), EXTRACT(month FROM rt_datetime.tsz2), EXTRACT(quarter FROM rt_datetime.tsz1), EXTRACT(second FROM rt_datetime.tsz2), EXTRACT(timezone FROM rt_datetime.tsz1), EXTRACT(timezone_hour FROM rt_datetime.tsz2), EXTRACT(timezone_minute FROM rt_datetime.tsz1), EXTRACT(week FROM rt_datetime.tsz2), EXTRACT(year FROM rt_datetime.tsz1)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, EXTRACT (century         FROM tsz1) v1,
           EXTRACT (day             FROM tsz2) v2,
           EXTRACT (decade          FROM tsz1) v3,
           EXTRACT (dow             FROM tsz2) v4,
           EXTRACT (doy             FROM tsz1) v5,
           EXTRACT (epoch           FROM tsz2) v6,
           EXTRACT (hour            FROM tsz1) v7,
           EXTRACT (isodow          FROM tsz2) v8,
           EXTRACT (isoyear         FROM tsz1) v9,
           EXTRACT (microseconds    FROM tsz2) v10,
           EXTRACT (millennium      FROM tsz1) v11,
           EXTRACT (milliseconds    FROM tsz2) v12,
           EXTRACT (minute          FROM tsz1) v13,
           EXTRACT (month           FROM tsz2) v14,
           EXTRACT (quarter         FROM tsz1) v15,
           EXTRACT (second          FROM tsz2) v16,
           EXTRACT (timezone        FROM tsz1) v17,
           EXTRACT (timezone_hour   FROM tsz2) v18,
           EXTRACT (timezone_minute FROM tsz1) v19,
           EXTRACT (week            FROM tsz2) v20,
           EXTRACT (year            FROM tsz1) v21
  INTO test44g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, EXTRACT (century         FROM tsz1) v1,
           EXTRACT (day             FROM tsz2) v2,
           EXTRACT (decade          FROM tsz1) v3,
           EXTRACT (dow             FROM tsz2) v4,
           EXTRACT (doy             FROM tsz1) v5,
           EXTRACT (epoch           FROM tsz2) v6,
           EXTRACT (hour            FROM tsz1) v7,
           EXTRACT (isodow          FROM tsz2) v8,
           EXTRACT (isoyear         FROM tsz1) v9,
           EXTRACT (microseconds    FROM tsz2) v10,
           EXTRACT (millennium      FROM tsz1) v11,
           EXTRACT (milliseconds    FROM tsz2) v12,
           EXTRACT (minute          FROM tsz1) v13,
           EXTRACT (month           FROM tsz2) v14,
           EXTRACT (quarter         FROM tsz1) v15,
           EXTRACT (second          FROM tsz2) v16,
           EXTRACT (timezone        FROM tsz1) v17,
           EXTRACT (timezone_hour   FROM tsz2) v18,
           EXTRACT (timezone_minute FROM tsz1) v19,
           EXTRACT (week            FROM tsz2) v20,
           EXTRACT (year            FROM tsz1) v21
  INTO test44p
  FROM rt_datetime
 WHERE id > 0;
SELECT * FROM test44g AS a, test44p AS b WHERE a.id=b.id AND
(
  ABS(a.v1 - b.v1) > 0.1
  OR ABS(a.v2 - b.v2) > 0.1
  OR ABS(a.v3 - b.v3) > 0.1
  OR ABS(a.v4 - b.v4) > 0.1
  OR ABS(a.v5 - b.v5) > 0.1
  OR ABS(a.v6 - b.v6) > 0.1
  OR ABS(a.v7 - b.v7) > 0.1
  OR ABS(a.v8 - b.v8) > 0.1
  OR ABS(a.v9 - b.v9) > 0.1
  OR ABS(a.v10 - b.v10) > 0.1
  OR ABS(a.v11 - b.v11) > 0.1
  OR ABS(a.v12 - b.v12) > 0.1
  OR ABS(a.v13 - b.v13) > 0.1
  OR ABS(a.v14 - b.v14) > 0.1
  OR ABS(a.v15 - b.v15) > 0.1
  OR ABS(a.v16 - b.v16) > 0.1
  OR ABS(a.v17 - b.v17) > 0.1
  OR ABS(a.v18 - b.v18) > 0.1
  OR ABS(a.v19 - b.v19) > 0.1
  OR ABS(a.v20 - b.v20) > 0.1
  OR ABS(a.v21 - b.v21) > 0.1
) LIMIT 5;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 | v13 | v14 | v15 | v16 | v17 | v18 | v19 | v20 | v21 | id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 | v13 | v14 | v15 | v16 | v17 | v18 | v19 | v20 | v21 
----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----
(0 rows)

-- extract() on 'interval' type
SET pg_strom.enabled = on;
EXPLAIN (costs off, verbose)
SELECT id, EXTRACT (microseconds FROM iv1) v1,
           EXTRACT (milliseconds FROM iv2) v2,
           EXTRACT (second       FROM iv1) v3,
           EXTRACT (minute       FROM iv2) v4,
           EXTRACT (hour         FROM iv1) v5,
           EXTRACT (day          FROM iv2) v6,
           EXTRACT (month        FROM iv1) v7,
           EXTRACT (quarter      FROM iv2) v8,
           EXTRACT (year         FROM iv1) v9,
           EXTRACT (decade       FROM iv2) v10,
           EXTRACT (century      FROM iv1) v11,
           EXTRACT (millennium   FROM iv2) v12
  INTO test45g
  FROM rt_datetime
 WHERE id > 0;
                                                                                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (GpuScan) on regtest_dtype_time_temp.rt_datetime
   Output: id, (EXTRACT(microseconds FROM iv1)), (EXTRACT(milliseconds FROM iv2)), (EXTRACT(second FROM iv1)), (EXTRACT(minute FROM iv2)), (EXTRACT(hour FROM iv1)), (EXTRACT(day FROM iv2)), (EXTRACT(month FROM iv1)), (EXTRACT(quarter FROM iv2)), (EXTRACT(year FROM iv1)), (EXTRACT(decade FROM iv2)), (EXTRACT(century FROM iv1)), (EXTRACT(millennium FROM iv2))
   GPU Projection: rt_datetime.id, EXTRACT(microseconds FROM rt_datetime.iv1), EXTRACT(milliseconds FROM rt_datetime.iv2), EXTRACT(second FROM rt_datetime.iv1), EXTRACT(minute FROM rt_datetime.iv2), EXTRACT(hour FROM rt_datetime.iv1), EXTRACT(day FROM rt_datetime.iv2), EXTRACT(month FROM rt_datetime.iv1), EXTRACT(quarter FROM rt_datetime.iv2), EXTRACT(year FROM rt_datetime.iv1), EXTRACT(decade FROM rt_datetime.iv2), EXTRACT(century FROM rt_datetime.iv1), EXTRACT(millennium FROM rt_datetime.iv2)
   GPU Scan Quals: (rt_datetime.id > 0)
(4 rows)

SELECT id, EXTRACT (microseconds FROM iv1) v1,
           EXTRACT (milliseconds FROM iv2) v2,
           EXTRACT (second       FROM iv1) v3,
           EXTRACT (minute       FROM iv2) v4,
           EXTRACT (hour         FROM iv1) v5,
           EXTRACT (day          FROM iv2) v6,
           EXTRACT (month        FROM iv1) v7,
           EXTRACT (quarter      FROM iv2) v8,
           EXTRACT (year         FROM iv1) v9,
           EXTRACT (decade       FROM iv2) v10,
           EXTRACT (century      FROM iv1) v11,
           EXTRACT (millennium   FROM iv2) v12
  INTO test45g
  FROM rt_datetime
 WHERE id > 0;
SET pg_strom.enabled = off;
SELECT id, EXTRACT (microseconds FROM iv1) v1,
           EXTRACT (milliseconds FROM iv2) v2,
           EXTRACT (second       FROM iv1) v3,
           EXTRACT (minute       FROM iv2) v4,
           EXTRACT (hour         FROM iv1) v5,
           EXTRACT (day          FROM iv2) v6,
           EXTRACT (month        FROM iv1) v7,
           EXTRACT (quarter      FROM iv2) v8,
           EXTRACT (year         FROM iv1) v9,
           EXTRACT (decade       FROM iv2) v10,
           EXTRACT (century      FROM iv1) v11,
           EXTRACT (millennium   FROM iv2) v12
  INTO test45p
  FROM rt_datetime
 WHERE id > 0;
SELECT * FROM test45g AS a, test45p AS b WHERE a.id=b.id AND
(
  ABS(a.v1 - b.v1) > 0.1
  OR ABS(a.v2 - b.v2) > 0.1
  OR ABS(a.v3 - b.v3) > 0.1
  OR ABS(a.v4 - b.v4) > 0.1
  OR ABS(a.v5 - b.v5) > 0.1
  OR ABS(a.v6 - b.v6) > 0.1
  OR ABS(a.v7 - b.v7) > 0.1
  OR ABS(a.v8 - b.v8) > 0.1
  OR ABS(a.v9 - b.v9) > 0.1
  OR ABS(a.v10 - b.v10) > 0.1
  OR ABS(a.v11 - b.v11) > 0.1
  OR ABS(a.v12 - b.v12) > 0.1
) LIMIT 5;
 id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 | id | v1 | v2 | v3 | v4 | v5 | v6 | v7 | v8 | v9 | v10 | v11 | v12 
----+----+----+----+----+----+----+----+----+----+-----+-----+-----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----
(0 rows)

-- cleanup temporary resource
SET client_min_messages = error;
DROP SCHEMA regtest_dtype_time_temp CASCADE;
