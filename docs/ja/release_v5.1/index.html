<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="PG-Strom Development Team" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>PG-Strom v5.1 - PG-Strom Manual</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="//fonts.googleapis.com/earlyaccess/notosansjp.css" rel="stylesheet" />
        <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" />
        <link href="../custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "PG-Strom v5.1";
        var mkdocs_page_input_path = "release_v5.1.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> PG-Strom Manual
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
  [<strong>Japanese</strong> | <a href="../../release_v5.1/"    style="color: #cccccc">English</a>]
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">はじめに</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../install/">インストール</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">利用ガイド</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../operations/">基本的な操作</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../brin/">BRINインデックス</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../partition/">パーティション</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../postgis/">GPU版PostGIS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gpusort/">GPUソート</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubles/">トラブルシューティング</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">先進機能</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ssd2gpu/">GPUダイレクトSQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../arrow_fdw/">Apache Arrow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gpucache/">GPUキャッシュ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pinned_buffer/">Pinned Inner Buffer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fluentd/">Fluentd連携</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">リファレンス</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_types/">データ型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_devfuncs/">関数と演算子</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sqlfuncs/">SQLオブジェクト</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_params/">GUCパラメータ</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">リリースノート</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../release_v6.0/">PG-Strom v6.0</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v5.2/">PG-Strom v5.2</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">PG-Strom v5.1</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_1">概要</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_2">動作環境</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">パーティション対応</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#gpu">GPUコードの起動時ビルド</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pg2arrow">pg2arrowの並列実行</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v5.0/">PG-Strom v5.0</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v3.0/">PG-Strom v3.0</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v2.3/">PG-Strom v2.3</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v2.2/">PG-Strom v2.2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release_v2.0/">PG-Strom v2.0</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">PG-Strom Manual</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">リリースノート</li>
      <li class="breadcrumb-item active">PG-Strom v5.1</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="pg-strom-v51">PG-Strom v5.1リリース</h1>
<div style="text-align: right;">PG-Strom Development Team (17-Apr-2024)</div>

<h2 id="_1">概要</h2>
<p>PG-Strom v5.1における主要な変更は点は以下の通りです。</p>
<ul>
<li>パーティションに対応したGpuJoin/PreAggのサポートを追加しました。</li>
<li>GPUコードのビルドを起動時に実行環境で行うようになりました。</li>
<li>pg2arrowが並列処理に対応しました。</li>
<li>CUDA Stackのサイズを適応的に設定するようになりました。</li>
<li>累積的なバグの修正</li>
</ul>
<h2 id="_2">動作環境</h2>
<ul>
<li>PostgreSQL v15.x, v16.x</li>
<li>CUDA Toolkit 12.2 以降</li>
<li>CUDA ToolkitのサポートするLinuxディストリビューション</li>
<li>Intel x86 64bit アーキテクチャ(x86_64)</li>
<li>NVIDIA GPU CC 6.0 以降 (Pascal以降; Volta以降を推奨)</li>
</ul>
<h2 id="_3">パーティション対応</h2>
<p>PostgreSQLパーティションへの対応自体はPG-Strom v3.0でも行われていましたが、うまく実行計画を作成できない事が多く、実験的ステータスを脱する事のできないものでした。そこで、PG-Strom v5.1では内部の設計を根本的に見直して再度実装し、再び正式な機能として取り入れました。</p>
<p>以下の<code>lineorder</code>テーブルがパーティション化されており、<code>date1</code>テーブルが非パーティション化テーブルである場合、これまでは、<code>lineorder</code>配下のパーティションテーブルから読み出したデータを全て<code>Append</code>ノードによって結合された後でなければJOINする事ができませんでした。
通常、PG-StromはCPUをバイパスしてNVME-SSDからGPUへデータをロードして各種のSQL処理を行う（GPU-Direct SQL）ため、JOINに先立ってCPU側へデータを戻さねばならないというのは大きなペナルティです。</p>
<pre><code>ssbm=# explain (costs off)
select sum(lo_extendedprice*lo_discount) as revenue
from lineorder,date1
where lo_orderdate = d_datekey
and d_year = 1993
and lo_discount between 1 and 3
and lo_quantity &lt; 25;
                                                                              QUERY PLAN
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate
   -&gt;  Hash Join
         Hash Cond: (lineorder.lo_orderdate = date1.d_datekey)
         -&gt;  Append
               -&gt;  Custom Scan (GpuScan) on lineorder__p1992 lineorder_1
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91250920 -&gt; 11911380]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1993 lineorder_2
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91008500 -&gt; 11980460]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1994 lineorder_3
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91044060 -&gt; 12150700]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1995 lineorder_4
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91011720 -&gt; 11779920]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1996 lineorder_5
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91305650 -&gt; 11942810]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1997 lineorder_6
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 91049100 -&gt; 12069740]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Custom Scan (GpuScan) on lineorder__p1998 lineorder_7
                     GPU Projection: lo_extendedprice, lo_discount, lo_orderdate
                     GPU Scan Quals: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric)) [rows: 53370560 -&gt; 6898138]
                     GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on lineorder__p1999 lineorder_8
                     Filter: ((lo_discount &gt;= '1'::numeric) AND (lo_discount &lt;= '3'::numeric) AND (lo_quantity &lt; '25'::numeric))
         -&gt;  Hash
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
(37 rows)
</code></pre>
<p>PG-Strom v5.1では、非パーティションテーブルをプッシュダウンし、パーティション子テーブルから読み出したデータとJOINしてから結果を返す事ができるようになりました。
場合によってはGROUP-BY処理まで済ませた上でCPU側に戻す事もでき、例えば以下の例では、総数6億件のパーティション子テーブルから検索条件を満たす7千万行を返さねばならないところ、非パーティションテーブルである<code>date1</code>とのJOINと、その次に実行する集約関数<code>SUM()</code>をパーティション子テーブルにプッシュダウンする事で、CPUでは僅か8行を処理するだけで済んでいます。</p>
<p>INNER側の読出しが複数回発生するというデメリットはありますが（※将来のバージョンで改修される予定です）、このような書き換えによってCPUで処理すべきデータが大幅に減少し、処理速度の改善に寄与します。</p>
<pre><code>ssbm=# explain (costs off)
select sum(lo_extendedprice*lo_discount) as revenue
from lineorder,date1
where lo_orderdate = d_datekey
and d_year = 1993
and lo_discount between 1 and 3
and lo_quantity &lt; 25;
                                               QUERY PLAN
----------------------------------------------------------------------------------------------------
 Aggregate
   -&gt;  Append
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1992 lineorder_1
               GPU Projection: pgstrom.psum(((lineorder_1.lo_extendedprice * lineorder_1.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_1.lo_discount &gt;= '1'::numeric) AND (lineorder_1.lo_discount &lt;= '3'::numeric) AND (lineorder_1.lo_quantity &lt; '25'::numeric)) [rows: 91250920 -&gt; 11911380]
               GPU Join Quals [1]: (lineorder_1.lo_orderdate = date1.d_datekey) ... [nrows: 11911380 -&gt; 1700960]
               GPU Outer Hash [1]: lineorder_1.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1993 lineorder_2
               GPU Projection: pgstrom.psum(((lineorder_2.lo_extendedprice * lineorder_2.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_2.lo_discount &gt;= '1'::numeric) AND (lineorder_2.lo_discount &lt;= '3'::numeric) AND (lineorder_2.lo_quantity &lt; '25'::numeric)) [rows: 91008500 -&gt; 11980460]
               GPU Join Quals [1]: (lineorder_2.lo_orderdate = date1.d_datekey) ... [nrows: 11980460 -&gt; 1710824]
               GPU Outer Hash [1]: lineorder_2.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1994 lineorder_3
               GPU Projection: pgstrom.psum(((lineorder_3.lo_extendedprice * lineorder_3.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_3.lo_discount &gt;= '1'::numeric) AND (lineorder_3.lo_discount &lt;= '3'::numeric) AND (lineorder_3.lo_quantity &lt; '25'::numeric)) [rows: 91044060 -&gt; 12150700]
               GPU Join Quals [1]: (lineorder_3.lo_orderdate = date1.d_datekey) ... [nrows: 12150700 -&gt; 1735135]
               GPU Outer Hash [1]: lineorder_3.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1995 lineorder_4
               GPU Projection: pgstrom.psum(((lineorder_4.lo_extendedprice * lineorder_4.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_4.lo_discount &gt;= '1'::numeric) AND (lineorder_4.lo_discount &lt;= '3'::numeric) AND (lineorder_4.lo_quantity &lt; '25'::numeric)) [rows: 91011720 -&gt; 11779920]
               GPU Join Quals [1]: (lineorder_4.lo_orderdate = date1.d_datekey) ... [nrows: 11779920 -&gt; 1682188]
               GPU Outer Hash [1]: lineorder_4.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1996 lineorder_5
               GPU Projection: pgstrom.psum(((lineorder_5.lo_extendedprice * lineorder_5.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_5.lo_discount &gt;= '1'::numeric) AND (lineorder_5.lo_discount &lt;= '3'::numeric) AND (lineorder_5.lo_quantity &lt; '25'::numeric)) [rows: 91305650 -&gt; 11942810]
               GPU Join Quals [1]: (lineorder_5.lo_orderdate = date1.d_datekey) ... [nrows: 11942810 -&gt; 1705448]
               GPU Outer Hash [1]: lineorder_5.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1997 lineorder_6
               GPU Projection: pgstrom.psum(((lineorder_6.lo_extendedprice * lineorder_6.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_6.lo_discount &gt;= '1'::numeric) AND (lineorder_6.lo_discount &lt;= '3'::numeric) AND (lineorder_6.lo_quantity &lt; '25'::numeric)) [rows: 91049100 -&gt; 12069740]
               GPU Join Quals [1]: (lineorder_6.lo_orderdate = date1.d_datekey) ... [nrows: 12069740 -&gt; 1723574]
               GPU Outer Hash [1]: lineorder_6.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1998 lineorder_7
               GPU Projection: pgstrom.psum(((lineorder_7.lo_extendedprice * lineorder_7.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_7.lo_discount &gt;= '1'::numeric) AND (lineorder_7.lo_discount &lt;= '3'::numeric) AND (lineorder_7.lo_quantity &lt; '25'::numeric)) [rows: 53370560 -&gt; 6898138]
               GPU Join Quals [1]: (lineorder_7.lo_orderdate = date1.d_datekey) ... [nrows: 6898138 -&gt; 985063]
               GPU Outer Hash [1]: lineorder_7.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
         -&gt;  Custom Scan (GpuPreAgg) on lineorder__p1999 lineorder_8
               GPU Projection: pgstrom.psum(((lineorder_8.lo_extendedprice * lineorder_8.lo_discount))::double precision)
               GPU Scan Quals: ((lineorder_8.lo_discount &gt;= '1'::numeric) AND (lineorder_8.lo_discount &lt;= '3'::numeric) AND (lineorder_8.lo_quantity &lt; '25'::numeric)) [rows: 150 -&gt; 1]
               GPU Join Quals [1]: (lineorder_8.lo_orderdate = date1.d_datekey) ... [nrows: 1 -&gt; 1]
               GPU Outer Hash [1]: lineorder_8.lo_orderdate
               GPU Inner Hash [1]: date1.d_datekey
               Inner Siblings-Id: 2
               GPU-Direct SQL: enabled (GPU-0)
               -&gt;  Seq Scan on date1
                     Filter: (d_year = 1993)
(82 rows)
</code></pre>
<h2 id="gpu">GPUコードの起動時ビルド</h2>
<p>以前のバージョンのPG-Stromでは、予めビルドされたGPU向けのバイナリモジュールを配布する方式をとっていました。
これはシンプルではあるのですが、PG-Strom（PostgreSQL）実行環境のCUDA ToolkitやNVIDIAドライバのバージョンの組合せによっては、GPUバイナリモジュールを認識できず実行時エラーを起こしてしまう事がありました。典型的には、RPMパッケージをビルドした環境よりも古いバージョンのCUDA ToolkitやNVIDIAドライバが実行環境にインストールされている場合です。</p>
<p>PG-Strom v5.1では、起動時にGPU用のソースコードやCUDA Toolkitのバージョンを確認し、差分があればGPU向けバイナリモジュールをビルドするように変更されました。この修正により、PG-Stromは実行環境にインストールされたGPUデバイス、およびCUDA Toolkit向けのGPUバイナリモジュールを利用することができるようになりました。</p>
<p>一部のPG-Strom用GPUモジュールにはビルドに時間がかかるものがあります。そのため、PG-StromやCUDA Toolkitのバージョンアップ後、初回の起動時にはPG-Stromの機能が利用可能となるまで数分の時間がかかる場合があります。</p>
<h2 id="pg2arrow">pg2arrowの並列実行</h2>
<p><code>pg2arrow</code>は新たに<code>-n|--num-workers</code>オプションと<code>-k|--parallel-keys</code>オプションをサポートするようになりました。</p>
<p><code>-n N_WORKERS</code>は指定した数のスレッドがそれぞれPostgreSQLに接続し、並列にクエリを実行した結果をApache Arrowファイルに書き込みます。クエリには特殊な文字列<code>$(N_WORKERS)</code>と<code>$(WORKER_ID)</code>を含む事ができ、これらはPostgreSQLにクエリを投げる際に、それぞれワーカー数とワーカー固有のID値に置き換えられます。ユーザはこれを利用して、各ワーカースレッドが読み出すタプルが互いに重複したり欠損したりしないように調整する必要があります。</p>
<p>もう一つの<code>-k|--parallel-key</code>オプションは、引数で与えたカンマ区切りのキー値のそれぞれに対してワーカースレッドを起動し、クエリ中の<code>$(PARALLEL_KEY)</code>をキーと置き換えた上で、これをPostgreSQLで実行した結果をApache Arrowファイルとして書き込みます。
例えば、<code>lineorder</code>テーブルがパーティション化されており、子テーブルとして、<code>lineorder__sun</code>, <code>lineorder__mon</code>, ... <code>lineorder__sat</code> が存在した場合、個々のワーカースレッドがパーティションの子テーブルをそれぞれスキャンするといった形で処理を並列化できます。
この場合、<code>-k</code>オプションは<code>-k sun,mon,tue,wed,thu,fri,sat</code>と指定し、<code>-c</code>オプションには<code>SELECT * FROM lineorder__$(PARALLEL_KEY)</code>と指定すれば、7個のワーカースレッドがそれぞれパーティションの子テーブルをスキャンする事になります。</p>
<pre><code>$ pg2arrow -d ssbm -c 'SELECT * FROM lineorder__$(PARALLEL_KEY)' -o /path/to/f_lineorder.arrow -k=sun,mon,tue,wed,thu,fri,sat --progress
worker:1 SQL=[SELECT * FROM lineorder__sun]
worker:3 SQL=[SELECT * FROM lineorder__tue]
worker:2 SQL=[SELECT * FROM lineorder__mon]
worker:4 SQL=[SELECT * FROM lineorder__wed]
worker:5 SQL=[SELECT * FROM lineorder__thu]
   :
   :
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../release_v5.2/" class="btn btn-neutral float-left" title="PG-Strom v5.2"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../release_v5.0/" class="btn btn-neutral float-right" title="PG-Strom v5.0">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../release_v5.2/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../release_v5.0/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
